<!DOCTYPE html>
<html lang="en-us">
  <head>
    <title>如何抓取中国人民银行调查统计司的数据 - org-page</title>
    <meta charset="utf-8" />
    <meta name="author" content="Shane Xu" />
    <meta name="description" content="如何抓取中国人民银行调查统计司的数据" />
    <meta name="keywords" content="数据采集" />
    <link rel="stylesheet" href="/media/css/main.css" type="text/css">
  </head>

  <body class="container">
    <div>
      <header class="masthead">
        <h1 class="masthead-title">
          <a href="/">org-page</a>
        </h1>
        <p>static site generator</p>
        <ul>
          <li><a href="/blog/">Blog</a></li>
          <li><a href="/tags/">Tags</a></li>
          <li><a href="/about/">About</a></li>
          <li><a href="https://github.com/shanexu">GitHub</a></li>
          <li><a href="/rss.xml">RSS</a></li>
        </ul>
        <form method="get" id="searchform" action="//www.google.com/search">
          <input type="text" class="field" name="q" id="s" placeholder="Search">
          <input type="hidden" name="as_sitesearch" value="xusheng.org">
        </form>
        <img class="avatar" src="https://avatars.githubusercontent.com/u/1257453?s=400&amp;u=887a49b5ff99794452aa0bc3772fe113cc6e962a&amp;v=4" />
      </header>
    </div>

<div>
<div class="post">
<h1>如何抓取中国人民银行调查统计司的数据</h1>
<p>
友人找我解决个问题，用python抓取中国人民银行调查统计司的一个页面(<a href="http://www.pbc.gov.cn/diaochatongjisi/116219/116319/index.html">http://www.pbc.gov.cn/diaochatongjisi/116219/116319/index.html</a>)的数据。原本以为这会是一个极其简单的问题。然而却碰到了一个磕绊。
</p>

<p>
首先用惯用手法， <code>curl</code> 看下裸的内容。
</p>

<div class="org-src-container">
<pre class="src src-text">$ curl -i  http://www.pbc.gov.cn/diaochatongjisi/116219/116319/index.html

HTTP/1.1 200 OK
Server: 360wzws
Date: Wed, 19 Oct 2016 15:04:28 GMT
Content-Type: text/html
Transfer-Encoding: chunked
Connection: keep-alive
Set-Cookie: wzwsconfirm=c638a799682c4ef7c292c212e0fc23db; path=/
Set-Cookie: wzwsvtime=1476889468; path=/

&lt;html&gt;
&lt;head&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;noscript&gt;
&lt;h1&gt;&lt;strong&gt;&#35831;&#24320;&#21551;JavaScript&#24182;&#21047;&#26032;&#35813;&#39029;.&lt;/strong&gt;&lt;/h1&gt;
&lt;/noscript&gt;
&lt;script type="text/javascript"&gt;
eval(function(p,a,c,k,e,d){e=function(c){return(c&lt;a?'':e(parseInt(c/a)))+((c=c%a)&gt;32?String.fromCharCode(c+32):c.toString(33))};if(!''.replace(/^/,String)){while(c--)d[e(c)]=k[c]||e(c);k=[function(e){return d[e]}];e=function(){return'\\w+'};c=1};while(c--)if(k[c])p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c]);return p}('15 D="k";15 1a="i";15 1b="l";15 11=d;15 F = "e+/=";J g(10) {15 U, N, R;15 o, p, q;R = 10.S;N = 0;U = "";17 (N &lt; R) {o = 10.s(N++) &amp; 6;O (N == R) {U += F.r(o &gt;&gt; a);U += F.r((o &amp; 1) &lt;&lt; b);U += "==";n;}p = 10.s(N++);O (N == R) {U += F.r(o &gt;&gt; a);U += F.r(((o &amp; 1) &lt;&lt; b) | ((p &amp; 5) &gt;&gt; b));U += F.r((p &amp; 4) &lt;&lt; a);U += "=";n;}q = 10.s(N++);U += F.r(o &gt;&gt; a);U += F.r(((o &amp; 1) &lt;&lt; b) | ((p &amp; 5) &gt;&gt; b));U += F.r(((p &amp; 4) &lt;&lt; a) | ((q &amp; 3) &gt;&gt; c));U += F.r(q &amp; 2);}W U;}J H(){15 16= 19.Q||B.C.u||B.m.u;15 K= 19.P||B.C.t||B.m.t;O (16*K &lt;= 8) {W 14;}15 1d = 19.Y;15 1e = 19.Z;O (1d + 16 &lt;= 0 || 1e + K &lt;= 0 || 1d &gt;= 19.X.18 || 1e &gt;= 19.X.M) {W 14;}W G;}J h(){15 12 = 1a+1b;15 L = 0;15 N    = 0;I(N = 0; N &lt; 12.S; N++) {L += 12.s(N);}L *= 9;L += 7;W "j"+L;}J f(){O(H()) {} E {15 A = ""; A = "1c="+g(11.13()) + "; V=/";B.w = A; 15 v = h();A = "1a="+g(v.13()) + "; V=/";B.w = A; 19.T=D;}}f();',59,74,'0|0x3|0x3f|0xc0|0xf|0xf0|0xff|111111|120000|19|2|4|6|7|ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789|HXXTTKKLLPPP5|KTKY2RBD9NHPBCIHV9ZMEQQDARSLVFDU|QWERTASDFGXYSF|RANDOMSTR11682|WZWS_CONFIRM_PREFIX_LABEL7|/diaochatongjisi/116219/116319/index.html|STRRANDOM11682|body|break|c1|c2|c3|charAt|charCodeAt|clientHeight|clientWidth|confirm|cookie|cookieString|document|documentElement|dynamicurl|else|encoderchars|false|findDimensions|for|function|h|hash|height|i|if|innerHeight|innerWidth|len|length|location|out|path|return|screen|screenX|screenY|str|template|tmp|toString|true|var|w|while|width|window|wzwschallenge|wzwschallengex|wzwstemplate|x|y'.split('|'),0,{}))
&lt;/script&gt;

&lt;/body&gt;
&lt;/html&gt;
</pre>
</div>

<p>
shit! 没有数据。也许是js里面渲染出来的。于是用 <code>chrome</code> 打开页面，查看页面源代码，我看到的东西是这样的:
</p>

<div class="org-src-container">
<pre class="src src-html"><span style="color: #b751b6;">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;</span>&lt;<span style="color: #a626a4;">html</span>&gt;
 &lt;<span style="color: #a626a4;">head</span>&gt;
  &lt;<span style="color: #a626a4;">meta</span> <span style="color: #6a1868;">http-equiv</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"Content-Type"</span> <span style="color: #6a1868;">content</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"text/html; charset=utf-8"</span> /&gt;&lt;<span style="color: #a626a4;">title</span>&gt;<span style="font-weight: bold; text-decoration: underline;">&#32479;&#35745;&#25968;&#25454;</span>&lt;/<span style="color: #a626a4;">title</span>&gt;
&lt;<span style="color: #a626a4;">meta</span>  <span style="color: #6a1868;">name</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"&#39029;&#38754;&#29983;&#25104;&#26102;&#38388;"</span> <span style="color: #6a1868;">content</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"2016-09-29 17:15:53"</span> /&gt;
&lt;<span style="color: #a626a4;">meta</span>  <span style="color: #6a1868;">name</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"&#32531;&#23384;&#28165;&#29702;&#26102;&#38388;"</span> <span style="color: #6a1868;">content</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"2016-09-02 17:42:14"</span>/&gt;
&lt;<span style="color: #a626a4;">meta</span>  <span style="color: #6a1868;">name</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"easysite&#29256;&#26412;"</span> <span style="color: #6a1868;">content</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"7.9.5"</span>/&gt;
&lt;<span style="color: #a626a4;">meta</span> <span style="color: #6a1868;">name</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"keywords"</span>  <span style="color: #6a1868;">content</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">""</span> /&gt;
&lt;<span style="color: #a626a4;">meta</span> <span style="color: #6a1868;">name</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"description"</span>  <span style="color: #6a1868;">content</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"&#32479;&#35745;&#25968;&#25454;"</span> /&gt;
............
<span style="color: #9ca0a4;">&lt;!--&#23548;&#33322; --&gt;</span>
&lt;<span style="color: #a626a4;">div</span> <span style="color: #6a1868;">id</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"logo"</span>&gt; 
  &lt;<span style="color: #a626a4;">div</span> <span style="color: #6a1868;">class</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"logo2"</span>&gt;
    &lt;<span style="color: #a626a4;">table</span> <span style="color: #6a1868;">width</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"950"</span> <span style="color: #6a1868;">height</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"100%"</span> <span style="color: #6a1868;">cellpadding</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"0"</span> <span style="color: #6a1868;">cellspacing</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"0"</span> <span style="color: #6a1868;">border</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"0"</span>&gt;
        &lt;<span style="color: #a626a4;">tr</span>&gt;
          &lt;<span style="color: #a626a4;">td</span> <span style="color: #6a1868;">width</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"119"</span> <span style="color: #6a1868;">align</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"center"</span> <span style="color: #6a1868;">valign</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"middle"</span> <span style="color: #6a1868;">id</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"biaotou"</span> <span style="color: #6a1868;">style</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"background-image:url(/eportal/fileDir/rmyh/template/common/header/gongkai1.jpg);"</span>&gt;&#20449;&#24687;&#20844;&#24320;&lt;/<span style="color: #a626a4;">td</span>&gt;
          &lt;<span style="color: #a626a4;">td</span> <span style="color: #6a1868;">width</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"831"</span> <span style="color: #6a1868;">style</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"background-image:url(/eportal/fileDir/rmyh/template/common/header/gongkai2.jpg);background-repeat:repeat-x;"</span>&gt;&lt;<span style="color: #a626a4;">table</span> <span style="color: #6a1868;">width</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"100%"</span> <span style="color: #6a1868;">height</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"100%"</span> <span style="color: #6a1868;">cellpadding</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"0"</span> <span style="color: #6a1868;">cellspacing</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"0"</span> <span style="color: #6a1868;">border</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"0"</span> <span style="color: #6a1868;">class</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"cs"</span>&gt;
              &lt;<span style="color: #a626a4;">tr</span>&gt;
                &lt;<span style="color: #a626a4;">td</span> <span style="color: #6a1868;">width</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"83"</span>&gt;&lt;<span style="color: #a626a4;">a</span> <span style="color: #6a1868;">href</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"/goutongjiaoliu/113456/113469/index.html"</span>  <span style="color: #6a1868;">target</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"_parent"</span>&gt;&#26032;&#38395;&#21457;&#24067;&lt;/<span style="color: #a626a4;">a</span>&gt;&lt;/<span style="color: #a626a4;">td</span>&gt;
                &lt;<span style="color: #a626a4;">td</span> <span style="color: #6a1868;">width</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"83"</span>&gt;&lt;<span style="color: #a626a4;">a</span> <span style="color: #6a1868;">href</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"/tiaofasi/144941/index.html"</span> <span style="color: #6a1868;">target</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"_parent"</span>&gt;&#27861;&#24459;&#27861;&#35268;&lt;/<span style="color: #a626a4;">a</span>&gt;&lt;/<span style="color: #a626a4;">td</span>&gt;
                &lt;<span style="color: #a626a4;">td</span> <span style="color: #6a1868;">width</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"83"</span>&gt;&lt;<span style="color: #a626a4;">a</span> <span style="color: #6a1868;">href</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"/rmyh/105145/index.html"</span>  <span style="color: #6a1868;">target</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"_parent"</span>&gt;&#36135;&#24065;&#25919;&#31574;&lt;/<span style="color: #a626a4;">a</span>&gt;&lt;/<span style="color: #a626a4;">td</span>&gt;
                &lt;<span style="color: #a626a4;">td</span> <span style="color: #6a1868;">width</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"83"</span>&gt;&lt;<span style="color: #a626a4;">a</span> <span style="color: #6a1868;">href</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"/jinrongshichangsi/147160/147289/index.html"</span>  <span style="color: #6a1868;">target</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"_parent"</span>&gt;&#20449;&#36151;&#25919;&#31574;&lt;/<span style="color: #a626a4;">a</span>&gt;&lt;/<span style="color: #a626a4;">td</span>&gt;
                &lt;<span style="color: #a626a4;">td</span> <span style="color: #6a1868;">width</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"83"</span>&gt;&lt;<span style="color: #a626a4;">a</span> <span style="color: #6a1868;">href</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"/jinrongshichangsi/147160/147171/index.html"</span>  <span style="color: #6a1868;">target</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"_parent"</span>&gt;&#37329;&#34701;&#24066;&#22330;&lt;/<span style="color: #a626a4;">a</span>&gt;&lt;/<span style="color: #a626a4;">td</span>&gt;
                &lt;<span style="color: #a626a4;">td</span> <span style="color: #6a1868;">width</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"83"</span>&gt;&lt;<span style="color: #a626a4;">a</span> <span style="color: #6a1868;">href</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"/jinrongwendingju/146766/index.html"</span>  <span style="color: #6a1868;">target</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"_parent"</span>&gt;&#37329;&#34701;&#31283;&#23450;&lt;/<span style="color: #a626a4;">a</span>&gt;&lt;/<span style="color: #a626a4;">td</span>&gt;
                &lt;<span style="color: #a626a4;">td</span> <span style="color: #6a1868;">width</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"83"</span>&gt;&lt;<span style="color: #a626a4;">a</span> <span style="color: #6a1868;">href</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"/diaochatongjisi/116219/index.html"</span> <span style="color: #6a1868;">target</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"_parent"</span>&gt;&#35843;&#26597;&#32479;&#35745;&lt;/<span style="color: #a626a4;">a</span>&gt;&lt;/<span style="color: #a626a4;">td</span>&gt;
                &lt;<span style="color: #a626a4;">td</span> <span style="color: #6a1868;">width</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"83"</span>&gt;&lt;<span style="color: #a626a4;">a</span> <span style="color: #6a1868;">href</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"/kuaijicaiwusi/145920/index.html"</span>  <span style="color: #6a1868;">target</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"_parent"</span>&gt;&#38134;&#34892;&#20250;&#35745;&lt;/<span style="color: #a626a4;">a</span>&gt;&lt;/<span style="color: #a626a4;">td</span>&gt;
                &lt;<span style="color: #a626a4;">td</span> <span style="color: #6a1868;">width</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"83"</span>&gt;&lt;<span style="color: #a626a4;">a</span> <span style="color: #6a1868;">href</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"/zhifujiesuansi/128525/index.html"</span>  <span style="color: #6a1868;">target</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"_parent"</span>&gt;&#25903;&#20184;&#20307;&#31995;&lt;/<span style="color: #a626a4;">a</span>&gt;&lt;/<span style="color: #a626a4;">td</span>&gt;
                &lt;<span style="color: #a626a4;">td</span> <span style="color: #6a1868;">width</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"84"</span> <span style="color: #6a1868;">style</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"border-right-style:none;"</span>&gt;&lt;<span style="color: #a626a4;">a</span> <span style="color: #6a1868;">href</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"/kejisi/146812/index.html"</span>  <span style="color: #6a1868;">target</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"_parent"</span>&gt;&#37329;&#34701;&#31185;&#25216;&lt;/<span style="color: #a626a4;">a</span>&gt;&lt;/<span style="color: #a626a4;">td</span>&gt;
              &lt;/<span style="color: #a626a4;">tr</span>&gt;
              &lt;<span style="color: #a626a4;">tr</span>&gt;
                &lt;<span style="color: #a626a4;">td</span> <span style="color: #6a1868;">colspan</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"10"</span> <span style="color: #6a1868;">style</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"border-right-style:none; height:6px;"</span>&gt;&lt;/<span style="color: #a626a4;">td</span>&gt;
              &lt;/<span style="color: #a626a4;">tr</span>&gt;
              &lt;<span style="color: #a626a4;">tr</span>&gt;
                &lt;<span style="color: #a626a4;">td</span> <span style="color: #6a1868;">width</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"83"</span>&gt;&lt;<span style="color: #a626a4;">a</span> <span style="color: #6a1868;">href</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"/huobijinyinju/147948/index.html"</span>  <span style="color: #6a1868;">target</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"_parent"</span>&gt;&#20154;&#27665;&#24065;&lt;/<span style="color: #a626a4;">a</span>&gt;&lt;/<span style="color: #a626a4;">td</span>&gt;
                &lt;<span style="color: #a626a4;">td</span> <span style="color: #6a1868;">width</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"83"</span>&gt;&lt;<span style="color: #a626a4;">a</span> <span style="color: #6a1868;">href</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"/guokuju/136142/index.html"</span>  <span style="color: #6a1868;">target</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"_parent"</span>&gt;&#32463;&#29702;&#22269;&#24211;&lt;/<span style="color: #a626a4;">a</span>&gt;&lt;/<span style="color: #a626a4;">td</span>&gt;
                &lt;<span style="color: #a626a4;">td</span> <span style="color: #6a1868;">width</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"83"</span>&gt;&lt;<span style="color: #a626a4;">a</span> <span style="color: #6a1868;">href</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"/goujisi/144449/index.html"</span>  <span style="color: #6a1868;">target</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"_parent"</span>&gt;&#22269;&#38469;&#20132;&#24448;&lt;/<span style="color: #a626a4;">a</span>&gt;&lt;/<span style="color: #a626a4;">td</span>&gt;
                &lt;<span style="color: #a626a4;">td</span> <span style="color: #6a1868;">width</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"83"</span>&gt;&lt;<span style="color: #a626a4;">a</span> <span style="color: #6a1868;">href</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"/renshisi/144501/144513/index.html"</span>  <span style="color: #6a1868;">target</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"_parent"</span>&gt;&#20154;&#21592;&#25307;&#24405;&lt;/<span style="color: #a626a4;">a</span>&gt;&lt;/<span style="color: #a626a4;">td</span>&gt;
                &lt;<span style="color: #a626a4;">td</span> <span style="color: #6a1868;">width</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"83"</span>&gt;&lt;<span style="color: #a626a4;">a</span> <span style="color: #6a1868;">href</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"/yanjiuju/124427/index.html"</span>  <span style="color: #6a1868;">target</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"_parent"</span>&gt;&#37329;&#34701;&#30740;&#31350;&lt;/<span style="color: #a626a4;">a</span>&gt;&lt;/<span style="color: #a626a4;">td</span>&gt;
                &lt;<span style="color: #a626a4;">td</span> <span style="color: #6a1868;">width</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"83"</span>&gt;&lt;<span style="color: #a626a4;">a</span> <span style="color: #6a1868;">href</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"/zhengxinguanliju/128332/index.html"</span>  <span style="color: #6a1868;">target</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"_parent"</span>&gt;&#24449;&#20449;&#31649;&#29702;&lt;/<span style="color: #a626a4;">a</span>&gt;&lt;/<span style="color: #a626a4;">td</span>&gt;
                &lt;<span style="color: #a626a4;">td</span> <span style="color: #6a1868;">width</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"83"</span>&gt;&lt;<span style="color: #a626a4;">a</span> <span style="color: #6a1868;">href</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"/fanxiqianju/135153/index.html"</span>  <span style="color: #6a1868;">target</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"_parent"</span>&gt;&#21453;&#27927;&#38065;&lt;/<span style="color: #a626a4;">a</span>&gt;&lt;/<span style="color: #a626a4;">td</span>&gt;
                &lt;<span style="color: #a626a4;">td</span> <span style="color: #6a1868;">width</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"83"</span>&gt;&lt;<span style="color: #a626a4;">a</span> <span style="color: #6a1868;">href</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"/dangweixuanchuanbu/110698/index.html"</span> <span style="color: #6a1868;">target</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"_parent"</span>&gt;&#20826;&#24314;&#24037;&#20316;&lt;/<span style="color: #a626a4;">a</span>&gt;&lt;/<span style="color: #a626a4;">td</span>&gt;
                &lt;<span style="color: #a626a4;">td</span> <span style="color: #6a1868;">width</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"83"</span>&gt;&lt;<span style="color: #a626a4;">a</span> <span style="color: #6a1868;">href</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"/gonghui/147897/index.html"</span> &gt;&#24037;&#20250;&#24037;&#20316;&lt;/<span style="color: #a626a4;">a</span>&gt;&lt;/<span style="color: #a626a4;">td</span>&gt;
                &lt;<span style="color: #a626a4;">td</span> <span style="color: #6a1868;">width</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"84"</span> <span style="color: #6a1868;">style</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"border-right-style:none;width:82px;"</span>&gt;&lt;<span style="color: #a626a4;">a</span> <span style="color: #6a1868;">href</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"/kejisi/146812/146832/index.html"</span> &gt;&#37329;&#34701;&#26631;&#20934;&#21270;&lt;/<span style="color: #a626a4;">a</span>&gt;&lt;/<span style="color: #a626a4;">td</span>&gt;
              &lt;/<span style="color: #a626a4;">tr</span>&gt;
            &lt;/<span style="color: #a626a4;">table</span>&gt;&lt;/<span style="color: #a626a4;">td</span>&gt;
        &lt;/<span style="color: #a626a4;">tr</span>&gt;
      &lt;/<span style="color: #a626a4;">table</span>&gt;
  &lt;/<span style="color: #a626a4;">div</span>&gt;
.............
&lt;/<span style="color: #a626a4;">div</span>&gt;&lt;<span style="color: #a626a4;">div</span> <span style="color: #6a1868;">style</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"display:none"</span> <span style="color: #6a1868;">easysite</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"easysiteHiddenDiv"</span>&gt;
&lt;<span style="color: #a626a4;">input</span> <span style="color: #6a1868;">type</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"hidden"</span>  <span style="color: #6a1868;">id</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"currentLoginUserLoginName"</span>/&gt;
&lt;<span style="color: #a626a4;">input</span> <span style="color: #6a1868;">type</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"hidden"</span>  <span style="color: #6a1868;">id</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"currentLoginUserLoginId"</span>/&gt;
&lt;/<span style="color: #a626a4;">div</span>&gt; &lt;/<span style="color: #a626a4;">body</span>&gt;
&lt;/<span style="color: #a626a4;">html</span>&gt;
</pre>
</div>

<p>
shit! 也许是http头里面有什么花样。于是用 <code>chrome</code> 调试工具里的 <code>Copy as cURL</code> 把浏览器发送的全部的头都拿到，得到的命令是这样的。
</p>

<div class="org-src-container">
<pre class="src src-bash"><span style="color: #4078f2; font-weight: bold;">curl</span> <span style="color: #50a14f;">'http://www.pbc.gov.cn/diaochatongjisi/116219/116319/index.html'</span> <span style="color: #b751b6;">-H</span> <span style="color: #50a14f;">'If-None-Match: W/"11827-d359-53da1eca7c440"'</span> <span style="color: #b751b6;">-H</span> <span style="color: #50a14f;">'Accept-Encoding: gzip, deflate, sdch'</span> <span style="color: #b751b6;">-H</span> <span style="color: #50a14f;">'Accept-Language: zh,en-US;q=0.8,en;q=0.6'</span> <span style="color: #b751b6;">-H</span> <span style="color: #50a14f;">'Upgrade-Insecure-Requests: 1'</span> <span style="color: #b751b6;">-H</span> <span style="color: #50a14f;">'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.143 Safari/537.36'</span> <span style="color: #b751b6;">-H</span> <span style="color: #50a14f;">'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8'</span> <span style="color: #b751b6;">-H</span> <span style="color: #50a14f;">'Referer: http://www.pbc.gov.cn/diaochatongjisi/116219/116319/index.html'</span> <span style="color: #b751b6;">-H</span> <span style="color: #50a14f;">'Cookie: sdfsdf; wzwsconfirm=b3ae4367ad93720e06c784de08ac826b; wzwstemplate=Mw==; ccpassport=6068335aa29d19017e67012d53b65ea5; wzwschallenge=-1; wzwsvtime=1476889531; _gscu_1042262807=76862674r67d3p17; _gscs_1042262807=t768895303f1std16|pv:1; _gscbrs_1042262807=1'</span> <span style="color: #b751b6;">-H</span> <span style="color: #50a14f;">'Connection: keep-alive'</span> <span style="color: #b751b6;">-H</span> <span style="color: #50a14f;">'If-Modified-Since: Thu, 29 Sep 2016 09:15:53 GMT'</span> <span style="color: #b751b6;">-H</span> <span style="color: #50a14f;">'Cache-Control: max-age=0'</span> <span style="color: #b751b6;">--compressed</span>
</pre>
</div>

<p>
一点一点去除无用的头，最后得到的命令是这样的。
</p>

<div class="org-src-container">
<pre class="src src-bash"><span style="color: #4078f2; font-weight: bold;">curl</span> <span style="color: #50a14f;">'http://www.pbc.gov.cn/diaochatongjisi/116219/116319/index.html'</span> <span style="color: #b751b6;">-H</span> <span style="color: #50a14f;">'Cookie: ccpassport=6068335aa29d19017e67012d53b65ea5;'</span>
</pre>
</div>

<p>
所以这个头里面的 <code>ccpassport</code> 就是重点。
</p>

<p>
一般来说cookie会在第一次访问这个网站的时候，服务器会发送 <code>Set-Cookie</code> 头给客户端，回看第一条命令的输出结果，的确有 <code>Set-Cookie</code> ，但是没有 <code>ccpassport</code> ，于是猜测就是第一个命令得到的一堆js，通过访问某个网址获取了 <code>ccpassport</code> cookie的。于是仔细看了下这个js。
</p>

<div class="org-src-container">
<pre class="src src-javascript"><span style="color: #4078f2; font-weight: bold;">eval</span><span style="color: #4078f2; background-color: #fafafa;">(</span><span style="color: #e45649;">function</span><span style="color: #a626a4; background-color: #fafafa;">(</span><span style="color: #6a1868;">p</span><span style="color: #383a42; background-color: #fafafa;">,</span><span style="color: #6a1868;">a</span><span style="color: #383a42; background-color: #fafafa;">,</span><span style="color: #6a1868;">c</span><span style="color: #383a42; background-color: #fafafa;">,</span><span style="color: #6a1868;">k</span><span style="color: #383a42; background-color: #fafafa;">,</span><span style="color: #6a1868;">e</span><span style="color: #383a42; background-color: #fafafa;">,</span><span style="color: #6a1868;">d</span><span style="color: #a626a4; background-color: #fafafa;">){</span><span style="color: #a626a4;">e</span><span style="color: #e45649;">=</span><span style="color: #e45649;">function</span><span style="color: #50a14f; background-color: #fafafa;">(</span><span style="color: #6a1868;">c</span><span style="color: #50a14f; background-color: #fafafa;">){</span><span style="color: #e45649;">return</span><span style="color: #b751b6; background-color: #fafafa;">(</span>c<span style="color: #e45649;">&lt;</span>a?<span style="color: #50a14f;">''</span>:<span style="color: #4078f2; font-weight: bold;">e</span><span style="color: #4db5bd; background-color: #fafafa;">(</span><span style="color: #4078f2; font-weight: bold;">parseInt</span><span style="color: #4078f2; background-color: #fafafa;">(</span>c/a<span style="color: #4078f2; background-color: #fafafa;">)</span><span style="color: #4db5bd; background-color: #fafafa;">)</span><span style="color: #b751b6; background-color: #fafafa;">)</span><span style="color: #e45649;">+</span><span style="color: #b751b6; background-color: #fafafa;">(</span><span style="color: #4db5bd; background-color: #fafafa;">(</span><span style="color: #6a1868;">c</span><span style="color: #e45649;">=</span>c%a<span style="color: #4db5bd; background-color: #fafafa;">)</span><span style="color: #e45649;">&gt;</span><span style="color: #b751b6;">32</span>?<span style="color: #986801;">String</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #4078f2; font-weight: bold; font-style: italic;">fromCharCode</span><span style="color: #4db5bd; background-color: #fafafa;">(</span>c<span style="color: #e45649;">+</span><span style="color: #b751b6;">32</span><span style="color: #4db5bd; background-color: #fafafa;">)</span>:c<span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #4078f2; font-weight: bold; font-style: italic;">toString</span><span style="color: #4db5bd; background-color: #fafafa;">(</span><span style="color: #b751b6;">33</span><span style="color: #4db5bd; background-color: #fafafa;">)</span><span style="color: #b751b6; background-color: #fafafa;">)</span><span style="color: #50a14f; background-color: #fafafa;">}</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #e45649;">if</span><span style="color: #50a14f; background-color: #fafafa;">(</span><span style="color: #e45649;">!</span><span style="color: #50a14f;">''</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #4078f2; font-weight: bold; font-style: italic;">replace</span><span style="color: #b751b6; background-color: #fafafa;">(</span><span style="color: #50a14f; font-weight: bold;">/^/</span><span style="color: #383a42; background-color: #fafafa;">,</span><span style="color: #986801;">String</span><span style="color: #b751b6; background-color: #fafafa;">)</span><span style="color: #50a14f; background-color: #fafafa;">){</span><span style="color: #e45649;">while</span><span style="color: #b751b6; background-color: #fafafa;">(</span>c<span style="color: #e45649;">--</span><span style="color: #b751b6; background-color: #fafafa;">)</span>d<span style="color: #b751b6; background-color: #fafafa;">[</span><span style="color: #4078f2; font-weight: bold;">e</span><span style="color: #4db5bd; background-color: #fafafa;">(</span>c<span style="color: #4db5bd; background-color: #fafafa;">)</span><span style="color: #b751b6; background-color: #fafafa;">]</span><span style="color: #e45649;">=</span>k<span style="color: #b751b6; background-color: #fafafa;">[</span>c<span style="color: #b751b6; background-color: #fafafa;">]</span><span style="color: #e45649;">||</span><span style="color: #4078f2; font-weight: bold;">e</span><span style="color: #b751b6; background-color: #fafafa;">(</span>c<span style="color: #b751b6; background-color: #fafafa;">)</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #6a1868;">k</span><span style="color: #e45649;">=</span><span style="color: #b751b6; background-color: #fafafa;">[</span><span style="color: #e45649;">function</span><span style="color: #4db5bd; background-color: #fafafa;">(</span><span style="color: #6a1868;">e</span><span style="color: #4db5bd; background-color: #fafafa;">){</span><span style="color: #e45649;">return</span> d<span style="color: #4078f2; background-color: #fafafa;">[</span>e<span style="color: #4078f2; background-color: #fafafa;">]</span><span style="color: #4db5bd; background-color: #fafafa;">}</span><span style="color: #b751b6; background-color: #fafafa;">]</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #a626a4;">e</span><span style="color: #e45649;">=</span><span style="color: #e45649;">function</span><span style="color: #b751b6; background-color: #fafafa;">(){</span><span style="color: #e45649;">return</span><span style="color: #50a14f;">'\\w+'</span><span style="color: #b751b6; background-color: #fafafa;">}</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #6a1868;">c</span><span style="color: #e45649;">=</span><span style="color: #b751b6;">1</span><span style="color: #50a14f; background-color: #fafafa;">}</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #e45649;">while</span><span style="color: #50a14f; background-color: #fafafa;">(</span>c<span style="color: #e45649;">--</span><span style="color: #50a14f; background-color: #fafafa;">)</span><span style="color: #e45649;">if</span><span style="color: #50a14f; background-color: #fafafa;">(</span>k<span style="color: #b751b6; background-color: #fafafa;">[</span>c<span style="color: #b751b6; background-color: #fafafa;">]</span><span style="color: #50a14f; background-color: #fafafa;">)</span><span style="color: #6a1868;">p</span><span style="color: #e45649;">=</span>p<span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #4078f2; font-weight: bold; font-style: italic;">replace</span><span style="color: #50a14f; background-color: #fafafa;">(</span><span style="color: #e45649;">new</span> <span style="color: #986801;">RegExp</span><span style="color: #b751b6; background-color: #fafafa;">(</span><span style="color: #50a14f;">'\\b'</span><span style="color: #e45649;">+</span><span style="color: #4078f2; font-weight: bold;">e</span><span style="color: #4db5bd; background-color: #fafafa;">(</span>c<span style="color: #4db5bd; background-color: #fafafa;">)</span><span style="color: #e45649;">+</span><span style="color: #50a14f;">'\\b'</span><span style="color: #383a42; background-color: #fafafa;">,</span><span style="color: #50a14f;">'g'</span><span style="color: #b751b6; background-color: #fafafa;">)</span><span style="color: #383a42; background-color: #fafafa;">,</span>k<span style="color: #b751b6; background-color: #fafafa;">[</span>c<span style="color: #b751b6; background-color: #fafafa;">]</span><span style="color: #50a14f; background-color: #fafafa;">)</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #e45649;">return</span> p<span style="color: #a626a4; background-color: #fafafa;">}(</span><span style="color: #50a14f;">'15 D="k";15 1a="i";15 1b="l";15 11=d;15 F = "e+/=";J g(10) {15 U, N, R;15 o, p, q;R = 10.S;N = 0;U = "";17 (N &lt; R) {o = 10.s(N++) &amp; 6;O (N == R) {U += F.r(o &gt;&gt; a);U += F.r((o &amp; 1) &lt;&lt; b);U += "==";n;}p = 10.s(N++);O (N == R) {U += F.r(o &gt;&gt; a);U += F.r(((o &amp; 1) &lt;&lt; b) | ((p &amp; 5) &gt;&gt; b));U += F.r((p &amp; 4) &lt;&lt; a);U += "=";n;}q = 10.s(N++);U += F.r(o &gt;&gt; a);U += F.r(((o &amp; 1) &lt;&lt; b) | ((p &amp; 5) &gt;&gt; b));U += F.r(((p &amp; 4) &lt;&lt; a) | ((q &amp; 3) &gt;&gt; c));U += F.r(q &amp; 2);}W U;}J H(){15 16= 19.Q||B.C.u||B.m.u;15 K= 19.P||B.C.t||B.m.t;O (16*K &lt;= 8) {W 14;}15 1d = 19.Y;15 1e = 19.Z;O (1d + 16 &lt;= 0 || 1e + K &lt;= 0 || 1d &gt;= 19.X.18 || 1e &gt;= 19.X.M) {W 14;}W G;}J h(){15 12 = 1a+1b;15 L = 0;15 N    = 0;I(N = 0; N &lt; 12.S; N++) {L += 12.s(N);}L *= 9;L += 7;W "j"+L;}J f(){O(H()) {} E {15 A = ""; A = "1c="+g(11.13()) + "; V=/";B.w = A; 15 v = h();A = "1a="+g(v.13()) + "; V=/";B.w = A; 19.T=D;}}f();'</span><span style="color: #383a42; background-color: #fafafa;">,</span><span style="color: #b751b6;">59</span><span style="color: #383a42; background-color: #fafafa;">,</span><span style="color: #b751b6;">74</span><span style="color: #383a42; background-color: #fafafa;">,</span><span style="color: #50a14f;">'0|0x3|0x3f|0xc0|0xf|0xf0|0xff|111111|120000|19|2|4|6|7|ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789|HXXTTKKLLPPP5|KTKY2RBD9NHPBCIHV9ZMEQQDARSLVFDU|QWERTASDFGXYSF|RANDOMSTR11682|WZWS_CONFIRM_PREFIX_LABEL7|/diaochatongjisi/116219/116319/index.html|STRRANDOM11682|body|break|c1|c2|c3|charAt|charCodeAt|clientHeight|clientWidth|confirm|cookie|cookieString|document|documentElement|dynamicurl|else|encoderchars|false|findDimensions|for|function|h|hash|height|i|if|innerHeight|innerWidth|len|length|location|out|path|return|screen|screenX|screenY|str|template|tmp|toString|true|var|w|while|width|window|wzwschallenge|wzwschallengex|wzwstemplate|x|y'</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #4078f2; font-weight: bold; font-style: italic;">split</span><span style="color: #50a14f; background-color: #fafafa;">(</span><span style="color: #50a14f;">'|'</span><span style="color: #50a14f; background-color: #fafafa;">)</span><span style="color: #383a42; background-color: #fafafa;">,</span><span style="color: #b751b6;">0</span><span style="color: #383a42; background-color: #fafafa;">,</span><span style="color: #50a14f; background-color: #fafafa;">{}</span><span style="color: #a626a4; background-color: #fafafa;">)</span><span style="color: #4078f2; background-color: #fafafa;">)</span>
</pre>
</div>

<p>
shit! 压缩过的代码。
</p>

<p>
js的 <code>eval</code> 是接收一个字符串，并将其如代码般执行一遍，所以 <code>eval</code> 里面的表达式的返回值应该是一个字符串，于是用 <code>console.log</code> 替换 <code>eval</code> ，在 <code>chrome</code> 调试终端中执行，得到结果如下。
</p>

<div class="org-src-container">
<pre class="src src-javascript"><span style="color: #e45649;">var</span> <span style="color: #6a1868;">dynamicurl</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"/diaochatongjisi/116219/116319/index.html"</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #e45649;">var</span> <span style="color: #6a1868;">wzwschallenge</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"RANDOMSTR11682"</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #e45649;">var</span> <span style="color: #6a1868;">wzwschallengex</span><span style="color: #e45649;">=</span><span style="color: #50a14f;">"STRRANDOM11682"</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #e45649;">var</span> <span style="color: #6a1868;">template</span><span style="color: #e45649;">=</span><span style="color: #b751b6;">7</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #e45649;">var</span> <span style="color: #6a1868;">encoderchars</span> <span style="color: #e45649;">=</span> <span style="color: #50a14f;">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #e45649;">function</span> <span style="color: #b751b6;">KTKY2RBD9NHPBCIHV9ZMEQQDARSLVFDU</span><span style="color: #4078f2; background-color: #fafafa;">(</span><span style="color: #6a1868;">str</span><span style="color: #4078f2; background-color: #fafafa;">)</span> <span style="color: #4078f2; background-color: #fafafa;">{</span><span style="color: #e45649;">var</span> <span style="color: #6a1868;">out</span><span style="color: #383a42; background-color: #fafafa;">,</span> <span style="color: #6a1868;">i</span><span style="color: #383a42; background-color: #fafafa;">,</span> <span style="color: #6a1868;">len</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #e45649;">var</span> <span style="color: #6a1868;">c1</span><span style="color: #383a42; background-color: #fafafa;">,</span> <span style="color: #6a1868;">c2</span><span style="color: #383a42; background-color: #fafafa;">,</span> <span style="color: #6a1868;">c3</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #6a1868;">len</span> <span style="color: #e45649;">=</span> str<span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #b751b6; font-style: italic;">length</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #6a1868;">i</span> <span style="color: #e45649;">=</span> <span style="color: #b751b6;">0</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #6a1868;">out</span> <span style="color: #e45649;">=</span> <span style="color: #50a14f;">""</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #e45649;">while</span> <span style="color: #a626a4; background-color: #fafafa;">(</span>i <span style="color: #e45649;">&lt;</span> len<span style="color: #a626a4; background-color: #fafafa;">)</span> <span style="color: #a626a4; background-color: #fafafa;">{</span><span style="color: #6a1868;">c1</span> <span style="color: #e45649;">=</span> str<span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #4078f2; font-weight: bold; font-style: italic;">charCodeAt</span><span style="color: #50a14f; background-color: #fafafa;">(</span>i<span style="color: #e45649;">++</span><span style="color: #50a14f; background-color: #fafafa;">)</span> &amp; <span style="color: #b751b6;">0xff</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #e45649;">if</span> <span style="color: #50a14f; background-color: #fafafa;">(</span>i <span style="color: #e45649;">==</span> len<span style="color: #50a14f; background-color: #fafafa;">)</span> <span style="color: #50a14f; background-color: #fafafa;">{</span><span style="color: #6a1868;">out</span> <span style="color: #e45649;">+=</span> encoderchars<span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #4078f2; font-weight: bold; font-style: italic;">charAt</span><span style="color: #b751b6; background-color: #fafafa;">(</span>c1 <span style="color: #e45649;">&gt;&gt;</span> <span style="color: #b751b6;">2</span><span style="color: #b751b6; background-color: #fafafa;">)</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #6a1868;">out</span> <span style="color: #e45649;">+=</span> encoderchars<span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #4078f2; font-weight: bold; font-style: italic;">charAt</span><span style="color: #b751b6; background-color: #fafafa;">(</span><span style="color: #4db5bd; background-color: #fafafa;">(</span>c1 &amp; <span style="color: #b751b6;">0x3</span><span style="color: #4db5bd; background-color: #fafafa;">)</span> <span style="color: #e45649;">&lt;&lt;</span> <span style="color: #b751b6;">4</span><span style="color: #b751b6; background-color: #fafafa;">)</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #6a1868;">out</span> <span style="color: #e45649;">+=</span> <span style="color: #50a14f;">"=="</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #e45649;">break</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #50a14f; background-color: #fafafa;">}</span><span style="color: #6a1868;">c2</span> <span style="color: #e45649;">=</span> str<span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #4078f2; font-weight: bold; font-style: italic;">charCodeAt</span><span style="color: #50a14f; background-color: #fafafa;">(</span>i<span style="color: #e45649;">++</span><span style="color: #50a14f; background-color: #fafafa;">)</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #e45649;">if</span> <span style="color: #50a14f; background-color: #fafafa;">(</span>i <span style="color: #e45649;">==</span> len<span style="color: #50a14f; background-color: #fafafa;">)</span> <span style="color: #50a14f; background-color: #fafafa;">{</span><span style="color: #6a1868;">out</span> <span style="color: #e45649;">+=</span> encoderchars<span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #4078f2; font-weight: bold; font-style: italic;">charAt</span><span style="color: #b751b6; background-color: #fafafa;">(</span>c1 <span style="color: #e45649;">&gt;&gt;</span> <span style="color: #b751b6;">2</span><span style="color: #b751b6; background-color: #fafafa;">)</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #6a1868;">out</span> <span style="color: #e45649;">+=</span> encoderchars<span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #4078f2; font-weight: bold; font-style: italic;">charAt</span><span style="color: #b751b6; background-color: #fafafa;">(</span><span style="color: #4db5bd; background-color: #fafafa;">(</span><span style="color: #4078f2; background-color: #fafafa;">(</span>c1 &amp; <span style="color: #b751b6;">0x3</span><span style="color: #4078f2; background-color: #fafafa;">)</span> <span style="color: #e45649;">&lt;&lt;</span> <span style="color: #b751b6;">4</span><span style="color: #4db5bd; background-color: #fafafa;">)</span> | <span style="color: #4db5bd; background-color: #fafafa;">(</span><span style="color: #4078f2; background-color: #fafafa;">(</span>c2 &amp; <span style="color: #b751b6;">0xf0</span><span style="color: #4078f2; background-color: #fafafa;">)</span> <span style="color: #e45649;">&gt;&gt;</span> <span style="color: #b751b6;">4</span><span style="color: #4db5bd; background-color: #fafafa;">)</span><span style="color: #b751b6; background-color: #fafafa;">)</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #6a1868;">out</span> <span style="color: #e45649;">+=</span> encoderchars<span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #4078f2; font-weight: bold; font-style: italic;">charAt</span><span style="color: #b751b6; background-color: #fafafa;">(</span><span style="color: #4db5bd; background-color: #fafafa;">(</span>c2 &amp; <span style="color: #b751b6;">0xf</span><span style="color: #4db5bd; background-color: #fafafa;">)</span> <span style="color: #e45649;">&lt;&lt;</span> <span style="color: #b751b6;">2</span><span style="color: #b751b6; background-color: #fafafa;">)</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #6a1868;">out</span> <span style="color: #e45649;">+=</span> <span style="color: #50a14f;">"="</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #e45649;">break</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #50a14f; background-color: #fafafa;">}</span><span style="color: #6a1868;">c3</span> <span style="color: #e45649;">=</span> str<span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #4078f2; font-weight: bold; font-style: italic;">charCodeAt</span><span style="color: #50a14f; background-color: #fafafa;">(</span>i<span style="color: #e45649;">++</span><span style="color: #50a14f; background-color: #fafafa;">)</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #6a1868;">out</span> <span style="color: #e45649;">+=</span> encoderchars<span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #4078f2; font-weight: bold; font-style: italic;">charAt</span><span style="color: #50a14f; background-color: #fafafa;">(</span>c1 <span style="color: #e45649;">&gt;&gt;</span> <span style="color: #b751b6;">2</span><span style="color: #50a14f; background-color: #fafafa;">)</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #6a1868;">out</span> <span style="color: #e45649;">+=</span> encoderchars<span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #4078f2; font-weight: bold; font-style: italic;">charAt</span><span style="color: #50a14f; background-color: #fafafa;">(</span><span style="color: #b751b6; background-color: #fafafa;">(</span><span style="color: #4db5bd; background-color: #fafafa;">(</span>c1 &amp; <span style="color: #b751b6;">0x3</span><span style="color: #4db5bd; background-color: #fafafa;">)</span> <span style="color: #e45649;">&lt;&lt;</span> <span style="color: #b751b6;">4</span><span style="color: #b751b6; background-color: #fafafa;">)</span> | <span style="color: #b751b6; background-color: #fafafa;">(</span><span style="color: #4db5bd; background-color: #fafafa;">(</span>c2 &amp; <span style="color: #b751b6;">0xf0</span><span style="color: #4db5bd; background-color: #fafafa;">)</span> <span style="color: #e45649;">&gt;&gt;</span> <span style="color: #b751b6;">4</span><span style="color: #b751b6; background-color: #fafafa;">)</span><span style="color: #50a14f; background-color: #fafafa;">)</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #6a1868;">out</span> <span style="color: #e45649;">+=</span> encoderchars<span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #4078f2; font-weight: bold; font-style: italic;">charAt</span><span style="color: #50a14f; background-color: #fafafa;">(</span><span style="color: #b751b6; background-color: #fafafa;">(</span><span style="color: #4db5bd; background-color: #fafafa;">(</span>c2 &amp; <span style="color: #b751b6;">0xf</span><span style="color: #4db5bd; background-color: #fafafa;">)</span> <span style="color: #e45649;">&lt;&lt;</span> <span style="color: #b751b6;">2</span><span style="color: #b751b6; background-color: #fafafa;">)</span> | <span style="color: #b751b6; background-color: #fafafa;">(</span><span style="color: #4db5bd; background-color: #fafafa;">(</span>c3 &amp; <span style="color: #b751b6;">0xc0</span><span style="color: #4db5bd; background-color: #fafafa;">)</span> <span style="color: #e45649;">&gt;&gt;</span> <span style="color: #b751b6;">6</span><span style="color: #b751b6; background-color: #fafafa;">)</span><span style="color: #50a14f; background-color: #fafafa;">)</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #6a1868;">out</span> <span style="color: #e45649;">+=</span> encoderchars<span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #4078f2; font-weight: bold; font-style: italic;">charAt</span><span style="color: #50a14f; background-color: #fafafa;">(</span>c3 &amp; <span style="color: #b751b6;">0x3f</span><span style="color: #50a14f; background-color: #fafafa;">)</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #a626a4; background-color: #fafafa;">}</span><span style="color: #e45649;">return</span> out<span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #4078f2; background-color: #fafafa;">}</span><span style="color: #e45649;">function</span> <span style="color: #a626a4;">findDimensions</span><span style="color: #4078f2; background-color: #fafafa;">(){</span><span style="color: #e45649;">var</span> <span style="color: #6a1868;">w</span><span style="color: #e45649;">=</span> <span style="color: #a626a4;">window</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #b751b6; font-style: italic;">innerWidth</span><span style="color: #e45649;">||</span><span style="color: #a626a4;">document</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #b751b6; font-style: italic;">documentElement</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #b751b6; font-style: italic;">clientWidth</span><span style="color: #e45649;">||</span><span style="color: #a626a4;">document</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #b751b6; font-style: italic;">body</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #b751b6; font-style: italic;">clientWidth</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #e45649;">var</span> <span style="color: #6a1868;">h</span><span style="color: #e45649;">=</span> <span style="color: #a626a4;">window</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #b751b6; font-style: italic;">innerHeight</span><span style="color: #e45649;">||</span><span style="color: #a626a4;">document</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #b751b6; font-style: italic;">documentElement</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #b751b6; font-style: italic;">clientHeight</span><span style="color: #e45649;">||</span><span style="color: #a626a4;">document</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #b751b6; font-style: italic;">body</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #b751b6; font-style: italic;">clientHeight</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #e45649;">if</span> <span style="color: #a626a4; background-color: #fafafa;">(</span>w*h <span style="color: #e45649;">&lt;=</span> <span style="color: #b751b6;">120000</span><span style="color: #a626a4; background-color: #fafafa;">)</span> <span style="color: #a626a4; background-color: #fafafa;">{</span><span style="color: #e45649;">return</span> <span style="color: #a626a4;">true</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #a626a4; background-color: #fafafa;">}</span><span style="color: #e45649;">var</span> <span style="color: #6a1868;">x</span> <span style="color: #e45649;">=</span> <span style="color: #a626a4;">window</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #b751b6; font-style: italic;">screenX</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #e45649;">var</span> <span style="color: #6a1868;">y</span> <span style="color: #e45649;">=</span> <span style="color: #a626a4;">window</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #b751b6; font-style: italic;">screenY</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #e45649;">if</span> <span style="color: #a626a4; background-color: #fafafa;">(</span>x <span style="color: #e45649;">+</span> w <span style="color: #e45649;">&lt;=</span> <span style="color: #b751b6;">0</span> <span style="color: #e45649;">||</span> y <span style="color: #e45649;">+</span> h <span style="color: #e45649;">&lt;=</span> <span style="color: #b751b6;">0</span> <span style="color: #e45649;">||</span> x <span style="color: #e45649;">&gt;=</span> <span style="color: #a626a4;">window</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #b751b6; font-style: italic;">screen</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #b751b6; font-style: italic;">width</span> <span style="color: #e45649;">||</span> y <span style="color: #e45649;">&gt;=</span> <span style="color: #a626a4;">window</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #b751b6; font-style: italic;">screen</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #b751b6; font-style: italic;">height</span><span style="color: #a626a4; background-color: #fafafa;">)</span> <span style="color: #a626a4; background-color: #fafafa;">{</span><span style="color: #e45649;">return</span> <span style="color: #a626a4;">true</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #a626a4; background-color: #fafafa;">}</span><span style="color: #e45649;">return</span> <span style="color: #a626a4;">false</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #4078f2; background-color: #fafafa;">}</span><span style="color: #e45649;">function</span> <span style="color: #b751b6;">QWERTASDFGXYSF</span><span style="color: #4078f2; background-color: #fafafa;">(){</span><span style="color: #e45649;">var</span> <span style="color: #6a1868;">tmp</span> <span style="color: #e45649;">=</span> wzwschallenge<span style="color: #e45649;">+</span>wzwschallengex<span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #e45649;">var</span> <span style="color: #6a1868;">hash</span> <span style="color: #e45649;">=</span> <span style="color: #b751b6;">0</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #e45649;">var</span> <span style="color: #6a1868;">i</span>    <span style="color: #e45649;">=</span> <span style="color: #b751b6;">0</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #e45649;">for</span><span style="color: #a626a4; background-color: #fafafa;">(</span><span style="color: #6a1868;">i</span> <span style="color: #e45649;">=</span> <span style="color: #b751b6;">0</span><span style="color: #383a42; background-color: #fafafa;">;</span> i <span style="color: #e45649;">&lt;</span> tmp<span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #b751b6; font-style: italic;">length</span><span style="color: #383a42; background-color: #fafafa;">;</span> i<span style="color: #e45649;">++</span><span style="color: #a626a4; background-color: #fafafa;">)</span> <span style="color: #a626a4; background-color: #fafafa;">{</span><span style="color: #6a1868;">hash</span> <span style="color: #e45649;">+=</span> tmp<span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #4078f2; font-weight: bold; font-style: italic;">charCodeAt</span><span style="color: #50a14f; background-color: #fafafa;">(</span>i<span style="color: #50a14f; background-color: #fafafa;">)</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #a626a4; background-color: #fafafa;">}</span><span style="color: #6a1868;">hash</span> *= <span style="color: #b751b6;">19</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #6a1868;">hash</span> <span style="color: #e45649;">+=</span> <span style="color: #b751b6;">111111</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #e45649;">return</span> <span style="color: #50a14f;">"WZWS_CONFIRM_PREFIX_LABEL7"</span><span style="color: #e45649;">+</span>hash<span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #4078f2; background-color: #fafafa;">}</span><span style="color: #e45649;">function</span> <span style="color: #b751b6;">HXXTTKKLLPPP5</span><span style="color: #4078f2; background-color: #fafafa;">(){</span><span style="color: #e45649;">if</span><span style="color: #a626a4; background-color: #fafafa;">(</span><span style="color: #4078f2; font-weight: bold;">findDimensions</span><span style="color: #50a14f; background-color: #fafafa;">()</span><span style="color: #a626a4; background-color: #fafafa;">)</span> <span style="color: #a626a4; background-color: #fafafa;">{}</span> <span style="color: #e45649;">else</span> <span style="color: #a626a4; background-color: #fafafa;">{</span><span style="color: #e45649;">var</span> <span style="color: #6a1868;">cookieString</span> <span style="color: #e45649;">=</span> <span style="color: #50a14f;">""</span><span style="color: #383a42; background-color: #fafafa;">;</span>  <span style="color: #6a1868;">cookieString</span> <span style="color: #e45649;">=</span> <span style="color: #50a14f;">"wzwstemplate="</span><span style="color: #e45649;">+</span><span style="color: #b751b6; font-weight: bold;">KTKY2RBD9NHPBCIHV9ZMEQQDARSLVFDU</span><span style="color: #50a14f; background-color: #fafafa;">(</span>template<span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #4078f2; font-weight: bold; font-style: italic;">toString</span><span style="color: #b751b6; background-color: #fafafa;">()</span><span style="color: #50a14f; background-color: #fafafa;">)</span> <span style="color: #e45649;">+</span> <span style="color: #50a14f;">"; path=/"</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #a626a4;">document</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #6a1868; font-style: italic;">cookie</span> <span style="color: #e45649;">=</span> cookieString<span style="color: #383a42; background-color: #fafafa;">;</span> <span style="color: #e45649;">var</span> <span style="color: #6a1868;">confirm</span> <span style="color: #e45649;">=</span> <span style="color: #b751b6; font-weight: bold;">QWERTASDFGXYSF</span><span style="color: #50a14f; background-color: #fafafa;">()</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #6a1868;">cookieString</span> <span style="color: #e45649;">=</span> <span style="color: #50a14f;">"wzwschallenge="</span><span style="color: #e45649;">+</span><span style="color: #b751b6; font-weight: bold;">KTKY2RBD9NHPBCIHV9ZMEQQDARSLVFDU</span><span style="color: #50a14f; background-color: #fafafa;">(</span>confirm<span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #4078f2; font-weight: bold; font-style: italic;">toString</span><span style="color: #b751b6; background-color: #fafafa;">()</span><span style="color: #50a14f; background-color: #fafafa;">)</span> <span style="color: #e45649;">+</span> <span style="color: #50a14f;">"; path=/"</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #a626a4;">document</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #6a1868; font-style: italic;">cookie</span> <span style="color: #e45649;">=</span> cookieString<span style="color: #383a42; background-color: #fafafa;">;</span>  <span style="color: #a626a4;">window</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #6a1868; font-style: italic;">location</span><span style="color: #e45649;">=</span>dynamicurl<span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #a626a4; background-color: #fafafa;">}</span><span style="color: #4078f2; background-color: #fafafa;">}</span><span style="color: #b751b6; font-weight: bold;">HXXTTKKLLPPP5</span><span style="color: #4078f2; background-color: #fafafa;">()</span><span style="color: #383a42; background-color: #fafafa;">;</span>
</pre>
</div>

<p>
用 <code>google</code> 搜索了个js <code>unminify</code> 的在线工具，得到了下面的结果：
</p>

<div class="org-src-container">
<pre class="src src-javascript"><span class="linenr"> 1: </span><span style="color: #e45649;">var</span> <span style="color: #6a1868;">dynamicurl</span> <span style="color: #e45649;">=</span> <span style="color: #50a14f;">"/diaochatongjisi/116219/116319/index.html"</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr"> 2: </span><span style="color: #e45649;">var</span> <span style="color: #6a1868;">wzwschallenge</span> <span style="color: #e45649;">=</span> <span style="color: #50a14f;">"RANDOMSTR11682"</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr"> 3: </span><span style="color: #e45649;">var</span> <span style="color: #6a1868;">wzwschallengex</span> <span style="color: #e45649;">=</span> <span style="color: #50a14f;">"STRRANDOM11682"</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr"> 4: </span><span style="color: #e45649;">var</span> <span style="color: #6a1868;">template</span> <span style="color: #e45649;">=</span> <span style="color: #b751b6;">7</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr"> 5: </span><span style="color: #e45649;">var</span> <span style="color: #6a1868;">encoderchars</span> <span style="color: #e45649;">=</span> <span style="color: #50a14f;">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr"> 6: </span>
<span class="linenr"> 7: </span><span style="color: #e45649;">function</span> <span style="color: #b751b6;">KTKY2RBD9NHPBCIHV9ZMEQQDARSLVFDU</span><span style="color: #4078f2; background-color: #fafafa;">(</span><span style="color: #6a1868;">str</span><span style="color: #4078f2; background-color: #fafafa;">)</span> <span style="color: #4078f2; background-color: #fafafa;">{</span>
<span class="linenr"> 8: </span>    <span style="color: #e45649;">var</span> <span style="color: #6a1868;">out</span><span style="color: #383a42; background-color: #fafafa;">,</span> <span style="color: #6a1868;">i</span><span style="color: #383a42; background-color: #fafafa;">,</span> <span style="color: #6a1868;">len</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr"> 9: </span>    <span style="color: #e45649;">var</span> <span style="color: #6a1868;">c1</span><span style="color: #383a42; background-color: #fafafa;">,</span> <span style="color: #6a1868;">c2</span><span style="color: #383a42; background-color: #fafafa;">,</span> <span style="color: #6a1868;">c3</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">10: </span>    <span style="color: #6a1868;">len</span> <span style="color: #e45649;">=</span> str<span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #b751b6; font-style: italic;">length</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">11: </span>    <span style="color: #6a1868;">i</span> <span style="color: #e45649;">=</span> <span style="color: #b751b6;">0</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">12: </span>    <span style="color: #6a1868;">out</span> <span style="color: #e45649;">=</span> <span style="color: #50a14f;">""</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">13: </span>    <span style="color: #e45649;">while</span> <span style="color: #a626a4; background-color: #fafafa;">(</span>i <span style="color: #e45649;">&lt;</span> len<span style="color: #a626a4; background-color: #fafafa;">)</span> <span style="color: #a626a4; background-color: #fafafa;">{</span>
<span class="linenr">14: </span>        <span style="color: #6a1868;">c1</span> <span style="color: #e45649;">=</span> str<span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #4078f2; font-weight: bold; font-style: italic;">charCodeAt</span><span style="color: #50a14f; background-color: #fafafa;">(</span>i<span style="color: #e45649;">++</span><span style="color: #50a14f; background-color: #fafafa;">)</span> &amp; <span style="color: #b751b6;">0xff</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">15: </span>        <span style="color: #e45649;">if</span> <span style="color: #50a14f; background-color: #fafafa;">(</span>i <span style="color: #e45649;">==</span> len<span style="color: #50a14f; background-color: #fafafa;">)</span> <span style="color: #50a14f; background-color: #fafafa;">{</span>
<span class="linenr">16: </span>            <span style="color: #6a1868;">out</span> <span style="color: #e45649;">+=</span> encoderchars<span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #4078f2; font-weight: bold; font-style: italic;">charAt</span><span style="color: #b751b6; background-color: #fafafa;">(</span>c1 <span style="color: #e45649;">&gt;&gt;</span> <span style="color: #b751b6;">2</span><span style="color: #b751b6; background-color: #fafafa;">)</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">17: </span>            <span style="color: #6a1868;">out</span> <span style="color: #e45649;">+=</span> encoderchars<span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #4078f2; font-weight: bold; font-style: italic;">charAt</span><span style="color: #b751b6; background-color: #fafafa;">(</span><span style="color: #4db5bd; background-color: #fafafa;">(</span>c1 &amp; <span style="color: #b751b6;">0x3</span><span style="color: #4db5bd; background-color: #fafafa;">)</span> <span style="color: #e45649;">&lt;&lt;</span> <span style="color: #b751b6;">4</span><span style="color: #b751b6; background-color: #fafafa;">)</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">18: </span>            <span style="color: #6a1868;">out</span> <span style="color: #e45649;">+=</span> <span style="color: #50a14f;">"=="</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">19: </span>            <span style="color: #e45649;">break</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">20: </span>        <span style="color: #50a14f; background-color: #fafafa;">}</span>
<span class="linenr">21: </span>        <span style="color: #6a1868;">c2</span> <span style="color: #e45649;">=</span> str<span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #4078f2; font-weight: bold; font-style: italic;">charCodeAt</span><span style="color: #50a14f; background-color: #fafafa;">(</span>i<span style="color: #e45649;">++</span><span style="color: #50a14f; background-color: #fafafa;">)</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">22: </span>        <span style="color: #e45649;">if</span> <span style="color: #50a14f; background-color: #fafafa;">(</span>i <span style="color: #e45649;">==</span> len<span style="color: #50a14f; background-color: #fafafa;">)</span> <span style="color: #50a14f; background-color: #fafafa;">{</span>
<span class="linenr">23: </span>            <span style="color: #6a1868;">out</span> <span style="color: #e45649;">+=</span> encoderchars<span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #4078f2; font-weight: bold; font-style: italic;">charAt</span><span style="color: #b751b6; background-color: #fafafa;">(</span>c1 <span style="color: #e45649;">&gt;&gt;</span> <span style="color: #b751b6;">2</span><span style="color: #b751b6; background-color: #fafafa;">)</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">24: </span>            <span style="color: #6a1868;">out</span> <span style="color: #e45649;">+=</span> encoderchars<span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #4078f2; font-weight: bold; font-style: italic;">charAt</span><span style="color: #b751b6; background-color: #fafafa;">(</span><span style="color: #4db5bd; background-color: #fafafa;">(</span><span style="color: #4078f2; background-color: #fafafa;">(</span>c1 &amp; <span style="color: #b751b6;">0x3</span><span style="color: #4078f2; background-color: #fafafa;">)</span> <span style="color: #e45649;">&lt;&lt;</span> <span style="color: #b751b6;">4</span><span style="color: #4db5bd; background-color: #fafafa;">)</span> | <span style="color: #4db5bd; background-color: #fafafa;">(</span><span style="color: #4078f2; background-color: #fafafa;">(</span>c2 &amp; <span style="color: #b751b6;">0xf0</span><span style="color: #4078f2; background-color: #fafafa;">)</span> <span style="color: #e45649;">&gt;&gt;</span> <span style="color: #b751b6;">4</span><span style="color: #4db5bd; background-color: #fafafa;">)</span><span style="color: #b751b6; background-color: #fafafa;">)</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">25: </span>            <span style="color: #6a1868;">out</span> <span style="color: #e45649;">+=</span> encoderchars<span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #4078f2; font-weight: bold; font-style: italic;">charAt</span><span style="color: #b751b6; background-color: #fafafa;">(</span><span style="color: #4db5bd; background-color: #fafafa;">(</span>c2 &amp; <span style="color: #b751b6;">0xf</span><span style="color: #4db5bd; background-color: #fafafa;">)</span> <span style="color: #e45649;">&lt;&lt;</span> <span style="color: #b751b6;">2</span><span style="color: #b751b6; background-color: #fafafa;">)</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">26: </span>            <span style="color: #6a1868;">out</span> <span style="color: #e45649;">+=</span> <span style="color: #50a14f;">"="</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">27: </span>            <span style="color: #e45649;">break</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">28: </span>        <span style="color: #50a14f; background-color: #fafafa;">}</span>
<span class="linenr">29: </span>        <span style="color: #6a1868;">c3</span> <span style="color: #e45649;">=</span> str<span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #4078f2; font-weight: bold; font-style: italic;">charCodeAt</span><span style="color: #50a14f; background-color: #fafafa;">(</span>i<span style="color: #e45649;">++</span><span style="color: #50a14f; background-color: #fafafa;">)</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">30: </span>        <span style="color: #6a1868;">out</span> <span style="color: #e45649;">+=</span> encoderchars<span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #4078f2; font-weight: bold; font-style: italic;">charAt</span><span style="color: #50a14f; background-color: #fafafa;">(</span>c1 <span style="color: #e45649;">&gt;&gt;</span> <span style="color: #b751b6;">2</span><span style="color: #50a14f; background-color: #fafafa;">)</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">31: </span>        <span style="color: #6a1868;">out</span> <span style="color: #e45649;">+=</span> encoderchars<span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #4078f2; font-weight: bold; font-style: italic;">charAt</span><span style="color: #50a14f; background-color: #fafafa;">(</span><span style="color: #b751b6; background-color: #fafafa;">(</span><span style="color: #4db5bd; background-color: #fafafa;">(</span>c1 &amp; <span style="color: #b751b6;">0x3</span><span style="color: #4db5bd; background-color: #fafafa;">)</span> <span style="color: #e45649;">&lt;&lt;</span> <span style="color: #b751b6;">4</span><span style="color: #b751b6; background-color: #fafafa;">)</span> | <span style="color: #b751b6; background-color: #fafafa;">(</span><span style="color: #4db5bd; background-color: #fafafa;">(</span>c2 &amp; <span style="color: #b751b6;">0xf0</span><span style="color: #4db5bd; background-color: #fafafa;">)</span> <span style="color: #e45649;">&gt;&gt;</span> <span style="color: #b751b6;">4</span><span style="color: #b751b6; background-color: #fafafa;">)</span><span style="color: #50a14f; background-color: #fafafa;">)</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">32: </span>        <span style="color: #6a1868;">out</span> <span style="color: #e45649;">+=</span> encoderchars<span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #4078f2; font-weight: bold; font-style: italic;">charAt</span><span style="color: #50a14f; background-color: #fafafa;">(</span><span style="color: #b751b6; background-color: #fafafa;">(</span><span style="color: #4db5bd; background-color: #fafafa;">(</span>c2 &amp; <span style="color: #b751b6;">0xf</span><span style="color: #4db5bd; background-color: #fafafa;">)</span> <span style="color: #e45649;">&lt;&lt;</span> <span style="color: #b751b6;">2</span><span style="color: #b751b6; background-color: #fafafa;">)</span> | <span style="color: #b751b6; background-color: #fafafa;">(</span><span style="color: #4db5bd; background-color: #fafafa;">(</span>c3 &amp; <span style="color: #b751b6;">0xc0</span><span style="color: #4db5bd; background-color: #fafafa;">)</span> <span style="color: #e45649;">&gt;&gt;</span> <span style="color: #b751b6;">6</span><span style="color: #b751b6; background-color: #fafafa;">)</span><span style="color: #50a14f; background-color: #fafafa;">)</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">33: </span>        <span style="color: #6a1868;">out</span> <span style="color: #e45649;">+=</span> encoderchars<span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #4078f2; font-weight: bold; font-style: italic;">charAt</span><span style="color: #50a14f; background-color: #fafafa;">(</span>c3 &amp; <span style="color: #b751b6;">0x3f</span><span style="color: #50a14f; background-color: #fafafa;">)</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">34: </span>    <span style="color: #a626a4; background-color: #fafafa;">}</span>
<span class="linenr">35: </span>    <span style="color: #e45649;">return</span> out<span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">36: </span><span style="color: #4078f2; background-color: #fafafa;">}</span>
<span class="linenr">37: </span>
<span class="linenr">38: </span><span style="color: #e45649;">function</span> <span style="color: #a626a4;">findDimensions</span><span style="color: #4078f2; background-color: #fafafa;">()</span> <span style="color: #4078f2; background-color: #fafafa;">{</span>
<span class="linenr">39: </span>    <span style="color: #e45649;">var</span> <span style="color: #6a1868;">w</span> <span style="color: #e45649;">=</span> <span style="color: #a626a4;">window</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #b751b6; font-style: italic;">innerWidth</span> <span style="color: #e45649;">||</span> <span style="color: #a626a4;">document</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #b751b6; font-style: italic;">documentElement</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #b751b6; font-style: italic;">clientWidth</span> <span style="color: #e45649;">||</span> <span style="color: #a626a4;">document</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #b751b6; font-style: italic;">body</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #b751b6; font-style: italic;">clientWidth</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">40: </span>    <span style="color: #e45649;">var</span> <span style="color: #6a1868;">h</span> <span style="color: #e45649;">=</span> <span style="color: #a626a4;">window</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #b751b6; font-style: italic;">innerHeight</span> <span style="color: #e45649;">||</span> <span style="color: #a626a4;">document</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #b751b6; font-style: italic;">documentElement</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #b751b6; font-style: italic;">clientHeight</span> <span style="color: #e45649;">||</span> <span style="color: #a626a4;">document</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #b751b6; font-style: italic;">body</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #b751b6; font-style: italic;">clientHeight</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">41: </span>    <span style="color: #e45649;">if</span> <span style="color: #a626a4; background-color: #fafafa;">(</span>w * h <span style="color: #e45649;">&lt;=</span> <span style="color: #b751b6;">120000</span><span style="color: #a626a4; background-color: #fafafa;">)</span> <span style="color: #a626a4; background-color: #fafafa;">{</span>
<span class="linenr">42: </span>        <span style="color: #e45649;">return</span> <span style="color: #a626a4;">true</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">43: </span>    <span style="color: #a626a4; background-color: #fafafa;">}</span>
<span class="linenr">44: </span>    <span style="color: #e45649;">var</span> <span style="color: #6a1868;">x</span> <span style="color: #e45649;">=</span> <span style="color: #a626a4;">window</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #b751b6; font-style: italic;">screenX</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">45: </span>    <span style="color: #e45649;">var</span> <span style="color: #6a1868;">y</span> <span style="color: #e45649;">=</span> <span style="color: #a626a4;">window</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #b751b6; font-style: italic;">screenY</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">46: </span>    <span style="color: #e45649;">if</span> <span style="color: #a626a4; background-color: #fafafa;">(</span>x <span style="color: #e45649;">+</span> w <span style="color: #e45649;">&lt;=</span> <span style="color: #b751b6;">0</span> <span style="color: #e45649;">||</span> y <span style="color: #e45649;">+</span> h <span style="color: #e45649;">&lt;=</span> <span style="color: #b751b6;">0</span> <span style="color: #e45649;">||</span> x <span style="color: #e45649;">&gt;=</span> <span style="color: #a626a4;">window</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #b751b6; font-style: italic;">screen</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #b751b6; font-style: italic;">width</span> <span style="color: #e45649;">||</span> y <span style="color: #e45649;">&gt;=</span> <span style="color: #a626a4;">window</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #b751b6; font-style: italic;">screen</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #b751b6; font-style: italic;">height</span><span style="color: #a626a4; background-color: #fafafa;">)</span> <span style="color: #a626a4; background-color: #fafafa;">{</span>
<span class="linenr">47: </span>        <span style="color: #e45649;">return</span> <span style="color: #a626a4;">true</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">48: </span>    <span style="color: #a626a4; background-color: #fafafa;">}</span>
<span class="linenr">49: </span>    <span style="color: #e45649;">return</span> <span style="color: #a626a4;">false</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">50: </span><span style="color: #4078f2; background-color: #fafafa;">}</span>
<span class="linenr">51: </span>
<span class="linenr">52: </span><span style="color: #e45649;">function</span> <span style="color: #b751b6;">QWERTASDFGXYSF</span><span style="color: #4078f2; background-color: #fafafa;">()</span> <span style="color: #4078f2; background-color: #fafafa;">{</span>
<span class="linenr">53: </span>    <span style="color: #e45649;">var</span> <span style="color: #6a1868;">tmp</span> <span style="color: #e45649;">=</span> wzwschallenge <span style="color: #e45649;">+</span> wzwschallengex<span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">54: </span>    <span style="color: #e45649;">var</span> <span style="color: #6a1868;">hash</span> <span style="color: #e45649;">=</span> <span style="color: #b751b6;">0</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">55: </span>    <span style="color: #e45649;">var</span> <span style="color: #6a1868;">i</span> <span style="color: #e45649;">=</span> <span style="color: #b751b6;">0</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">56: </span>    <span style="color: #e45649;">for</span> <span style="color: #a626a4; background-color: #fafafa;">(</span><span style="color: #6a1868;">i</span> <span style="color: #e45649;">=</span> <span style="color: #b751b6;">0</span><span style="color: #383a42; background-color: #fafafa;">;</span> i <span style="color: #e45649;">&lt;</span> tmp<span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #b751b6; font-style: italic;">length</span><span style="color: #383a42; background-color: #fafafa;">;</span> i<span style="color: #e45649;">++</span><span style="color: #a626a4; background-color: #fafafa;">)</span> <span style="color: #a626a4; background-color: #fafafa;">{</span>
<span class="linenr">57: </span>        <span style="color: #6a1868;">hash</span> <span style="color: #e45649;">+=</span> tmp<span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #4078f2; font-weight: bold; font-style: italic;">charCodeAt</span><span style="color: #50a14f; background-color: #fafafa;">(</span>i<span style="color: #50a14f; background-color: #fafafa;">)</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">58: </span>    <span style="color: #a626a4; background-color: #fafafa;">}</span>
<span class="linenr">59: </span>    <span style="color: #6a1868;">hash</span> *= <span style="color: #b751b6;">19</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">60: </span>    <span style="color: #6a1868;">hash</span> <span style="color: #e45649;">+=</span> <span style="color: #b751b6;">111111</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">61: </span>    <span style="color: #e45649;">return</span> <span style="color: #50a14f;">"WZWS_CONFIRM_PREFIX_LABEL7"</span> <span style="color: #e45649;">+</span> hash<span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">62: </span><span style="color: #4078f2; background-color: #fafafa;">}</span>
<span class="linenr">63: </span>
<span class="linenr">64: </span><span style="color: #e45649;">function</span> <span style="color: #b751b6;">HXXTTKKLLPPP5</span><span style="color: #4078f2; background-color: #fafafa;">()</span> <span style="color: #4078f2; background-color: #fafafa;">{</span>
<span class="linenr">65: </span>    <span style="color: #e45649;">if</span> <span style="color: #a626a4; background-color: #fafafa;">(</span><span style="color: #4078f2; font-weight: bold;">findDimensions</span><span style="color: #50a14f; background-color: #fafafa;">()</span><span style="color: #a626a4; background-color: #fafafa;">)</span> <span style="color: #a626a4; background-color: #fafafa;">{}</span> <span style="color: #e45649;">else</span> <span style="color: #a626a4; background-color: #fafafa;">{</span>
<span class="linenr">66: </span>        <span style="color: #e45649;">var</span> <span style="color: #6a1868;">cookieString</span> <span style="color: #e45649;">=</span> <span style="color: #50a14f;">""</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">67: </span>        <span style="color: #6a1868;">cookieString</span> <span style="color: #e45649;">=</span> <span style="color: #50a14f;">"wzwstemplate="</span> <span style="color: #e45649;">+</span> <span style="color: #b751b6; font-weight: bold;">KTKY2RBD9NHPBCIHV9ZMEQQDARSLVFDU</span><span style="color: #50a14f; background-color: #fafafa;">(</span>template<span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #4078f2; font-weight: bold; font-style: italic;">toString</span><span style="color: #b751b6; background-color: #fafafa;">()</span><span style="color: #50a14f; background-color: #fafafa;">)</span> <span style="color: #e45649;">+</span> <span style="color: #50a14f;">"; path=/"</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">68: </span>        <span style="color: #a626a4;">document</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #6a1868; font-style: italic;">cookie</span> <span style="color: #e45649;">=</span> cookieString<span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">69: </span>        <span style="color: #e45649;">var</span> <span style="color: #6a1868;">confirm</span> <span style="color: #e45649;">=</span> <span style="color: #b751b6; font-weight: bold;">QWERTASDFGXYSF</span><span style="color: #50a14f; background-color: #fafafa;">()</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">70: </span>        <span style="color: #6a1868;">cookieString</span> <span style="color: #e45649;">=</span> <span style="color: #50a14f;">"wzwschallenge="</span> <span style="color: #e45649;">+</span> <span style="color: #b751b6; font-weight: bold;">KTKY2RBD9NHPBCIHV9ZMEQQDARSLVFDU</span><span style="color: #50a14f; background-color: #fafafa;">(</span>confirm<span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #4078f2; font-weight: bold; font-style: italic;">toString</span><span style="color: #b751b6; background-color: #fafafa;">()</span><span style="color: #50a14f; background-color: #fafafa;">)</span> <span style="color: #e45649;">+</span> <span style="color: #50a14f;">"; path=/"</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">71: </span>        <span style="color: #a626a4;">document</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #6a1868; font-style: italic;">cookie</span> <span style="color: #e45649;">=</span> cookieString<span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">72: </span>        <span style="color: #a626a4;">window</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #6a1868; font-style: italic;">location</span> <span style="color: #e45649;">=</span> dynamicurl<span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">73: </span>    <span style="color: #a626a4; background-color: #fafafa;">}</span>
<span class="linenr">74: </span><span style="color: #4078f2; background-color: #fafafa;">}</span>
<span class="linenr">75: </span><span style="color: #b751b6; font-weight: bold;">HXXTTKKLLPPP5</span><span style="color: #4078f2; background-color: #fafafa;">()</span><span style="color: #383a42; background-color: #fafafa;">;</span>
</pre>
</div>

<p>
只看最后一个看书 <code>HXXTTKKLLPPP5</code> ，通过几个方法，设置了cookie，然后再重新访问了当前网址。打开 <code>node</code> ，目测直接运行这些代码必然，会有问题，于是稍微开了下，给 <code>node</code> 环境造了一个虚假的浏览器环境。
</p>

<div class="org-src-container">
<pre class="src src-javascript"><span class="linenr"> 1: </span><span style="color: #e45649;">var</span> <span style="color: #a626a4;">window</span> <span style="color: #e45649;">=</span> <span style="color: #4078f2; background-color: #fafafa;">{</span><span style="color: #6a1868;">innerWidth</span>: <span style="color: #b751b6;">1280</span><span style="color: #383a42; background-color: #fafafa;">,</span> <span style="color: #6a1868;">innerHeight</span>: <span style="color: #b751b6;">800</span><span style="color: #383a42; background-color: #fafafa;">,</span> <span style="color: #6a1868;">screenX</span>: <span style="color: #b751b6;">0</span><span style="color: #383a42; background-color: #fafafa;">,</span> <span style="color: #6a1868;">screenY</span>: <span style="color: #b751b6;">0</span><span style="color: #383a42; background-color: #fafafa;">,</span> <span style="color: #6a1868;">screen</span>: <span style="color: #a626a4; background-color: #fafafa;">{</span><span style="color: #6a1868;">width</span>: <span style="color: #b751b6;">1280</span><span style="color: #383a42; background-color: #fafafa;">,</span> <span style="color: #6a1868;">height</span>: <span style="color: #b751b6;">800</span><span style="color: #a626a4; background-color: #fafafa;">}</span><span style="color: #4078f2; background-color: #fafafa;">}</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr"> 2: </span><span style="color: #e45649;">var</span> <span style="color: #a626a4;">document</span> <span style="color: #e45649;">=</span> <span style="color: #4078f2; background-color: #fafafa;">(</span><span style="color: #e45649;">function</span><span style="color: #a626a4; background-color: #fafafa;">(){</span>
<span class="linenr"> 3: </span>    <span style="color: #e45649;">var</span> <span style="color: #6a1868;">cookies</span> <span style="color: #e45649;">=</span> <span style="color: #50a14f; background-color: #fafafa;">[]</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr"> 4: </span>    <span style="color: #e45649;">return</span> <span style="color: #50a14f; background-color: #fafafa;">{</span>
<span class="linenr"> 5: </span>        <span style="color: #e45649;">get</span> <span style="color: #a626a4;">cookie</span><span style="color: #b751b6; background-color: #fafafa;">()</span> <span style="color: #b751b6; background-color: #fafafa;">{</span>
<span class="linenr"> 6: </span>            <span style="color: #e45649;">return</span> cookies<span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr"> 7: </span>        <span style="color: #b751b6; background-color: #fafafa;">}</span><span style="color: #383a42; background-color: #fafafa;">,</span>
<span class="linenr"> 8: </span>        <span style="color: #e45649;">set</span> <span style="color: #a626a4;">cookie</span><span style="color: #b751b6; background-color: #fafafa;">(</span><span style="color: #6a1868;">c</span><span style="color: #b751b6; background-color: #fafafa;">)</span> <span style="color: #b751b6; background-color: #fafafa;">{</span>
<span class="linenr"> 9: </span>            cookies<span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #4078f2; font-weight: bold; font-style: italic;">push</span><span style="color: #4db5bd; background-color: #fafafa;">(</span>c<span style="color: #4db5bd; background-color: #fafafa;">)</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">10: </span>        <span style="color: #b751b6; background-color: #fafafa;">}</span>
<span class="linenr">11: </span>    <span style="color: #50a14f; background-color: #fafafa;">}</span>
<span class="linenr">12: </span><span style="color: #a626a4; background-color: #fafafa;">}</span><span style="color: #4078f2; background-color: #fafafa;">)()</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">13: </span><span style="color: #4078f2; font-weight: bold;">eval</span><span style="color: #4078f2; background-color: #fafafa;">(</span><span style="color: #e45649;">function</span><span style="color: #a626a4; background-color: #fafafa;">(</span><span style="color: #6a1868;">p</span><span style="color: #383a42; background-color: #fafafa;">,</span><span style="color: #6a1868;">a</span><span style="color: #383a42; background-color: #fafafa;">,</span><span style="color: #6a1868;">c</span><span style="color: #383a42; background-color: #fafafa;">,</span><span style="color: #6a1868;">k</span><span style="color: #383a42; background-color: #fafafa;">,</span><span style="color: #6a1868;">e</span><span style="color: #383a42; background-color: #fafafa;">,</span><span style="color: #6a1868;">d</span><span style="color: #a626a4; background-color: #fafafa;">){</span><span style="color: #a626a4;">e</span><span style="color: #e45649;">=</span><span style="color: #e45649;">function</span><span style="color: #50a14f; background-color: #fafafa;">(</span><span style="color: #6a1868;">c</span><span style="color: #50a14f; background-color: #fafafa;">){</span><span style="color: #e45649;">return</span><span style="color: #b751b6; background-color: #fafafa;">(</span>c<span style="color: #e45649;">&lt;</span>a?<span style="color: #50a14f;">''</span>:<span style="color: #4078f2; font-weight: bold;">e</span><span style="color: #4db5bd; background-color: #fafafa;">(</span><span style="color: #4078f2; font-weight: bold;">parseInt</span><span style="color: #4078f2; background-color: #fafafa;">(</span>c/a<span style="color: #4078f2; background-color: #fafafa;">)</span><span style="color: #4db5bd; background-color: #fafafa;">)</span><span style="color: #b751b6; background-color: #fafafa;">)</span><span style="color: #e45649;">+</span><span style="color: #b751b6; background-color: #fafafa;">(</span><span style="color: #4db5bd; background-color: #fafafa;">(</span><span style="color: #6a1868;">c</span><span style="color: #e45649;">=</span>c%a<span style="color: #4db5bd; background-color: #fafafa;">)</span><span style="color: #e45649;">&gt;</span><span style="color: #b751b6;">32</span>?<span style="color: #986801;">String</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #4078f2; font-weight: bold; font-style: italic;">fromCharCode</span><span style="color: #4db5bd; background-color: #fafafa;">(</span>c<span style="color: #e45649;">+</span><span style="color: #b751b6;">32</span><span style="color: #4db5bd; background-color: #fafafa;">)</span>:c<span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #4078f2; font-weight: bold; font-style: italic;">toString</span><span style="color: #4db5bd; background-color: #fafafa;">(</span><span style="color: #b751b6;">33</span><span style="color: #4db5bd; background-color: #fafafa;">)</span><span style="color: #b751b6; background-color: #fafafa;">)</span><span style="color: #50a14f; background-color: #fafafa;">}</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #e45649;">if</span><span style="color: #50a14f; background-color: #fafafa;">(</span><span style="color: #e45649;">!</span><span style="color: #50a14f;">''</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #4078f2; font-weight: bold; font-style: italic;">replace</span><span style="color: #b751b6; background-color: #fafafa;">(</span><span style="color: #50a14f; font-weight: bold;">/^/</span><span style="color: #383a42; background-color: #fafafa;">,</span><span style="color: #986801;">String</span><span style="color: #b751b6; background-color: #fafafa;">)</span><span style="color: #50a14f; background-color: #fafafa;">){</span><span style="color: #e45649;">while</span><span style="color: #b751b6; background-color: #fafafa;">(</span>c<span style="color: #e45649;">--</span><span style="color: #b751b6; background-color: #fafafa;">)</span>d<span style="color: #b751b6; background-color: #fafafa;">[</span><span style="color: #4078f2; font-weight: bold;">e</span><span style="color: #4db5bd; background-color: #fafafa;">(</span>c<span style="color: #4db5bd; background-color: #fafafa;">)</span><span style="color: #b751b6; background-color: #fafafa;">]</span><span style="color: #e45649;">=</span>k<span style="color: #b751b6; background-color: #fafafa;">[</span>c<span style="color: #b751b6; background-color: #fafafa;">]</span><span style="color: #e45649;">||</span><span style="color: #4078f2; font-weight: bold;">e</span><span style="color: #b751b6; background-color: #fafafa;">(</span>c<span style="color: #b751b6; background-color: #fafafa;">)</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #6a1868;">k</span><span style="color: #e45649;">=</span><span style="color: #b751b6; background-color: #fafafa;">[</span><span style="color: #e45649;">function</span><span style="color: #4db5bd; background-color: #fafafa;">(</span><span style="color: #6a1868;">e</span><span style="color: #4db5bd; background-color: #fafafa;">){</span><span style="color: #e45649;">return</span> d<span style="color: #4078f2; background-color: #fafafa;">[</span>e<span style="color: #4078f2; background-color: #fafafa;">]</span><span style="color: #4db5bd; background-color: #fafafa;">}</span><span style="color: #b751b6; background-color: #fafafa;">]</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #a626a4;">e</span><span style="color: #e45649;">=</span><span style="color: #e45649;">function</span><span style="color: #b751b6; background-color: #fafafa;">(){</span><span style="color: #e45649;">return</span><span style="color: #50a14f;">'\\w+'</span><span style="color: #b751b6; background-color: #fafafa;">}</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #6a1868;">c</span><span style="color: #e45649;">=</span><span style="color: #b751b6;">1</span><span style="color: #50a14f; background-color: #fafafa;">}</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #e45649;">while</span><span style="color: #50a14f; background-color: #fafafa;">(</span>c<span style="color: #e45649;">--</span><span style="color: #50a14f; background-color: #fafafa;">)</span><span style="color: #e45649;">if</span><span style="color: #50a14f; background-color: #fafafa;">(</span>k<span style="color: #b751b6; background-color: #fafafa;">[</span>c<span style="color: #b751b6; background-color: #fafafa;">]</span><span style="color: #50a14f; background-color: #fafafa;">)</span><span style="color: #6a1868;">p</span><span style="color: #e45649;">=</span>p<span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #4078f2; font-weight: bold; font-style: italic;">replace</span><span style="color: #50a14f; background-color: #fafafa;">(</span><span style="color: #e45649;">new</span> <span style="color: #986801;">RegExp</span><span style="color: #b751b6; background-color: #fafafa;">(</span><span style="color: #50a14f;">'\\b'</span><span style="color: #e45649;">+</span><span style="color: #4078f2; font-weight: bold;">e</span><span style="color: #4db5bd; background-color: #fafafa;">(</span>c<span style="color: #4db5bd; background-color: #fafafa;">)</span><span style="color: #e45649;">+</span><span style="color: #50a14f;">'\\b'</span><span style="color: #383a42; background-color: #fafafa;">,</span><span style="color: #50a14f;">'g'</span><span style="color: #b751b6; background-color: #fafafa;">)</span><span style="color: #383a42; background-color: #fafafa;">,</span>k<span style="color: #b751b6; background-color: #fafafa;">[</span>c<span style="color: #b751b6; background-color: #fafafa;">]</span><span style="color: #50a14f; background-color: #fafafa;">)</span><span style="color: #383a42; background-color: #fafafa;">;</span><span style="color: #e45649;">return</span> p<span style="color: #a626a4; background-color: #fafafa;">}(</span><span style="color: #50a14f;">'15 D="k";15 1a="i";15 1b="l";15 11=d;15 F = "e+/=";J g(10) {15 U, N, R;15 o, p, q;R = 10.S;N = 0;U = "";17 (N &lt; R) {o = 10.s(N++) &amp; 6;O (N == R) {U += F.r(o &gt;&gt; a);U += F.r((o &amp; 1) &lt;&lt; b);U += "==";n;}p = 10.s(N++);O (N == R) {U += F.r(o &gt;&gt; a);U += F.r(((o &amp; 1) &lt;&lt; b) | ((p &amp; 5) &gt;&gt; b));U += F.r((p &amp; 4) &lt;&lt; a);U += "=";n;}q = 10.s(N++);U += F.r(o &gt;&gt; a);U += F.r(((o &amp; 1) &lt;&lt; b) | ((p &amp; 5) &gt;&gt; b));U += F.r(((p &amp; 4) &lt;&lt; a) | ((q &amp; 3) &gt;&gt; c));U += F.r(q &amp; 2);}W U;}J H(){15 16= 19.Q||B.C.u||B.m.u;15 K= 19.P||B.C.t||B.m.t;O (16*K &lt;= 8) {W 14;}15 1d = 19.Y;15 1e = 19.Z;O (1d + 16 &lt;= 0 || 1e + K &lt;= 0 || 1d &gt;= 19.X.18 || 1e &gt;= 19.X.M) {W 14;}W G;}J h(){15 12 = 1a+1b;15 L = 0;15 N    = 0;I(N = 0; N &lt; 12.S; N++) {L += 12.s(N);}L *= 9;L += 7;W "j"+L;}J f(){O(H()) {} E {15 A = ""; A = "1c="+g(11.13()) + "; V=/";B.w = A; 15 v = h();A = "1a="+g(v.13()) + "; V=/";B.w = A; 19.T=D;}}f();'</span><span style="color: #383a42; background-color: #fafafa;">,</span><span style="color: #b751b6;">59</span><span style="color: #383a42; background-color: #fafafa;">,</span><span style="color: #b751b6;">74</span><span style="color: #383a42; background-color: #fafafa;">,</span><span style="color: #50a14f;">'0|0x3|0x3f|0xc0|0xf|0xf0|0xff|111111|120000|19|2|4|6|7|ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789|HXXTTKKLLPPP5|KTKY2RBD9NHPBCIHV9ZMEQQDARSLVFDU|QWERTASDFGXYSF|RANDOMSTR11682|WZWS_CONFIRM_PREFIX_LABEL7|/diaochatongjisi/116219/116319/index.html|STRRANDOM11682|body|break|c1|c2|c3|charAt|charCodeAt|clientHeight|clientWidth|confirm|cookie|cookieString|document|documentElement|dynamicurl|else|encoderchars|false|findDimensions|for|function|h|hash|height|i|if|innerHeight|innerWidth|len|length|location|out|path|return|screen|screenX|screenY|str|template|tmp|toString|true|var|w|while|width|window|wzwschallenge|wzwschallengex|wzwstemplate|x|y'</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #4078f2; font-weight: bold; font-style: italic;">split</span><span style="color: #50a14f; background-color: #fafafa;">(</span><span style="color: #50a14f;">'|'</span><span style="color: #50a14f; background-color: #fafafa;">)</span><span style="color: #383a42; background-color: #fafafa;">,</span><span style="color: #b751b6;">0</span><span style="color: #383a42; background-color: #fafafa;">,</span><span style="color: #50a14f; background-color: #fafafa;">{}</span><span style="color: #a626a4; background-color: #fafafa;">)</span><span style="color: #4078f2; background-color: #fafafa;">)</span><span style="color: #383a42; background-color: #fafafa;">;</span>
<span class="linenr">14: </span><span style="color: #a626a4;">document</span><span style="color: #383a42; background-color: #fafafa;">.</span><span style="color: #b751b6; font-style: italic;">cookie</span><span style="color: #383a42; background-color: #fafafa;">;</span>
</pre>
</div>

<p>
在node.js里面跑一遍，获得下面的结果:
</p>

<div class="org-src-container">
<pre class="src src-javascript"><span style="color: #4078f2; background-color: #fafafa;">[</span> 
    <span style="color: #50a14f;">'wzwstemplate=Nw==; path=/'</span><span style="color: #383a42; background-color: #fafafa;">,</span>
    <span style="color: #50a14f;">'wzwschallenge=V1pXU19DT05GSVJNX1BSRUZJWF9MQUJFTDcxNDc0Mzk=; path=/'</span> 
<span style="color: #4078f2; background-color: #fafafa;">]</span>
</pre>
</div>

<p>
在第二次访问那个地址的时候，浏览器是带着上面两个cookie，以及原先的cookie一起访问了，那个网址，所以才能得到正确的内容。所以这个网站的爬取思路，就是：
</p>
<ol class="org-ol">
<li>不带任何cookie访问网址</li>
<li>运行返回的js，并获得两个cookie，并和第1步的cookie一起，访问网址</li>
<li>获得结果</li>
</ol>

<p>
不像java，python貌似没有js引擎，网上搜了下，有人做了个 <a href="https://pypi.python.org/pypi/PyExecJS">PyExecJS</a> 这个库函，可以调用各个平台自身的js引擎，从而在python中运行js。它支持的js运行环境有如下：
</p>
<ul class="org-ul">
<li>PyV8 - A python wrapper for Google V8 engine,</li>
<li>Node.js</li>
<li>Apple JavaScriptCore - Included with Mac OS X</li>
<li>Mozilla SpiderMonkey</li>
<li>Microsoft Windows Script Host (JScript)</li>
<li>SlimerJS</li>
<li>PhantomJS</li>
<li>Nashorn - Included with Oracle Java 8</li>
</ul>

<p>
这里用 <code>PyExecJS</code>, <code>Beautiful Soup</code>, <code>Requests</code>, 写一个简单的抓取脚本
</p>

<script src="https://gist.github.com/shanexu/cc343f1e2106ca4fd623264694504cf8.js"></script>

</div>
</div>
    <div>
      <div class="post-meta">
        <span title="post date" class="post-info">2016-10-19</span>
        <span title="last modification date" class="post-info">2017-04-16</span>
        <span title="tags" class="post-info"><a href="/tags/python/">python</a>, <a href="/tags/javascript/">javascript</a></span>
        <span title="author" class="post-info">Shane Xu</span>
      </div>
      <section>
        <h1>Comments</h1>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
          //var disqus_developer = 1;
          var disqus_identifier = "/blog/2016/10/19/ru-he-zhua-qu-diao-cha-tong-ji-si-de-shu-ju";
          var disqus_url = "https://xusheng.org/blog/2016/10/19/ru-he-zhua-qu-diao-cha-tong-ji-si-de-shu-ju";
          var disqus_shortname = 'shanexu';
          /* * * DON'T EDIT BELOW THIS LINE * * */
          (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="//disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
       <div id="hashover"></div>
       <script type="text/javascript" src="/hashover.php"></script>
       <noscript>You must have JavaScript enabled to use the comments.</noscript>
      </section>
      <script src="//code.jquery.com/jquery-latest.min.js"></script>
      <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script src="/media/js/main.js"></script>
      <script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-74684473-1']);
        _gaq.push(['_trackPageview']);
        (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
      </script>
      <div class="footer">
        <p>Generated by <a href="http://www.gnu.org/software/emacs/">Emacs</a> 29.x (<a href="http://orgmode.org">Org mode</a> 9.x)</p>
        <p>
          Copyright &copy; 2012 - <span id="footerYear"></span> <a href="mailto:xusheng0711 &lt;at&gt; gmail &lt;dot&gt; com">Shane Xu</a>
          &nbsp;&nbsp;-&nbsp;&nbsp;
          Powered by <a href="https://github.com/kelvinh/org-page" target="_blank">org-page</a>
          <script type="text/javascript">document.getElementById("footerYear").innerHTML = (new Date()).getFullYear();</script>
        </p>
      </div>
    </div>

  </body>
</html>

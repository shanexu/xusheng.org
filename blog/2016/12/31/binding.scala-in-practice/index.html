<!DOCTYPE html>
<html lang="en-us">
  <head>
    <title>Binding.scala in Practice - org-page</title>
    <meta charset="utf-8" />
    <meta name="author" content="Shane Xu" />
    <meta name="description" content="&lt;TODO: insert your description here&gt;" />
    <meta name="keywords" content="scala.js, Binding.scala, scala" />
    <link rel="stylesheet" href="/media/css/main.css" type="text/css">
  </head>

  <body class="container">
    <div>
      <header class="masthead">
        <h1 class="masthead-title">
          <a href="/">org-page</a>
        </h1>
        <p>static site generator</p>
        <ul>
          <li><a href="/blog/">Blog</a></li>
          <li><a href="/tags/">Tags</a></li>
          <li><a href="/about/">About</a></li>
          <li><a href="https://github.com/shanexu">GitHub</a></li>
          <li><a href="/rss.xml">RSS</a></li>
        </ul>
        <form method="get" id="searchform" action="//www.google.com/search">
          <input type="text" class="field" name="q" id="s" placeholder="Search">
          <input type="hidden" name="as_sitesearch" value="xusheng.org">
        </form>
        <img class="avatar" src="https://avatars.githubusercontent.com/u/1257453?s=400&amp;u=887a49b5ff99794452aa0bc3772fe113cc6e962a&amp;v=4" />
      </header>
    </div>

<div>
<div class="post">
<h1>Binding.scala in Practice</h1>
<p>
开了这个题目之后，我久久不知道如何动笔。搁置了一周之后，我终于下定决心写好这篇文章。我就来写写，我这两星期 <code>我</code> 和 <a href="https://www.scala-js.org/">scala.js</a> 以及 <a href="https://github.com/ThoughtWorksInc/Binding.scala">Binding.scala</a> 浴血奋战的故事(<a href="http://music.163.com/#/song?id=22790726">You and Music and Dream</a>)。
</p>

<p>
首先，创建一个最简单的 scala.js with Binding.scala 的项目。
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #2aa1ae; font-weight: bold;">mkdir</span> simple-scala.js-Binding.scala
<span style="color: #3a81c3; font-weight: bold;">cd</span> simple-scala.js-Binding.scala
<span style="color: #2aa1ae; font-weight: bold;">mkdir</span> <span style="color: #4e3163;">-p</span> js/src/<span style="color: #3a81c3;">{</span>main,test<span style="color: #3a81c3;">}</span>/scala
<span style="color: #2aa1ae; font-weight: bold;">mkdir</span> project
<span style="color: #3a81c3; font-weight: bold;">echo</span> sbt.version=<span style="color: #4e3163;">0.13.13</span> <span style="color: #3a81c3; font-weight: bold;">&gt;</span> project/build.properties
<span style="color: #3a81c3; font-weight: bold;">echo</span> <span style="color: #2d9574;">'resolvers += "Typesafe Releases" at "http://repo.typesafe.com/typesafe/releases/"</span>

<span style="color: #2d9574;">addSbtPlugin("org.scala-js" % "sbt-scalajs" % "0.6.14")</span>

<span style="color: #2d9574;">addSbtPlugin("com.eed3si9n" % "sbt-assembly" % "0.14.3")</span>
<span style="color: #2d9574;">'</span> <span style="color: #3a81c3; font-weight: bold;">&gt;</span> project/plugin.sbt
<span style="color: #2aa1ae; font-weight: bold;">touch</span> build.sbt
</pre>
</div>

<p>
然后在 <code>build.sbt</code> 中添加如下内容。
</p>

<div class="org-src-container">
<pre class="src src-scala"><span class="linenr"> 1: </span><span style="color: #3a81c3;">lazy</span> <span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">commonSettings</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #4e3163;">Seq</span><span style="color: #3a81c3;">(</span>
<span class="linenr"> 2: </span>  version := <span style="color: #2d9574;">"0.0.1"</span>,
<span class="linenr"> 3: </span>  scalaVersion := <span style="color: #2d9574;">"2.11.8"</span>,
<span class="linenr"> 4: </span>  addCompilerPlugin<span style="color: #6c3163;">(</span><span style="color: #2d9574;">"org.scalamacros"</span> % <span style="color: #2d9574;">"paradise"</span> % <span style="color: #2d9574;">"2.1.0"</span> cross <span style="color: #4e3163;">CrossVersion</span>.full<span style="color: #6c3163;">)</span>,
<span class="linenr"> 5: </span>  scalacOptions ++= <span style="color: #4e3163;">Seq</span><span style="color: #6c3163;">(</span><span style="color: #2d9574;">"-feature"</span>, <span style="color: #2d9574;">"-language:implicitConversions"</span><span style="color: #6c3163;">)</span>
<span class="linenr"> 6: </span><span style="color: #3a81c3;">)</span>
<span class="linenr"> 7: </span>
<span class="linenr"> 8: </span><span style="color: #3a81c3;">lazy</span> <span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">BindingScalaVersion</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574;">"10.0.1"</span>
<span class="linenr"> 9: </span>
<span class="linenr">10: </span><span style="color: #3a81c3;">lazy</span> <span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">root</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #3a81c3;">(</span>project in file<span style="color: #6c3163;">(</span><span style="color: #2d9574;">"."</span><span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>.
<span class="linenr">11: </span>  settings<span style="color: #3a81c3;">(</span>commonSettings<span style="color: #3a81c3; font-weight: bold;">:</span> <span style="color: #3a81c3; font-weight: bold;">_</span>*<span style="color: #3a81c3;">)</span>.
<span class="linenr">12: </span>  aggregate<span style="color: #3a81c3;">(</span>js<span style="color: #3a81c3;">)</span>
<span class="linenr">13: </span>
<span class="linenr">14: </span><span style="color: #3a81c3;">lazy</span> <span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">js</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #3a81c3;">(</span>project in file<span style="color: #6c3163;">(</span><span style="color: #2d9574;">"js"</span><span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>.
<span class="linenr">15: </span>  settings<span style="color: #3a81c3;">(</span>commonSettings<span style="color: #3a81c3; font-weight: bold;">:</span> <span style="color: #3a81c3; font-weight: bold;">_</span>*<span style="color: #3a81c3;">)</span>.
<span class="linenr">16: </span>  settings<span style="color: #3a81c3;">(</span>
<span class="linenr">17: </span>    mainClass in <span style="color: #6c3163;">(</span><span style="color: #4e3163;">Compile</span><span style="color: #6c3163;">)</span> := <span style="color: #4e3163;">Some</span><span style="color: #6c3163;">(</span><span style="color: #2d9574;">"Application"</span><span style="color: #6c3163;">)</span>,
<span class="linenr">18: </span>    persistLauncher := <span style="color: #4e3163;">true</span>,
<span class="linenr">19: </span>    libraryDependencies ++= <span style="color: #4e3163;">Seq</span><span style="color: #6c3163;">(</span>
<span class="linenr">20: </span>      <span style="color: #2d9574;">"org.scala-js"</span> %%% <span style="color: #2d9574;">"scalajs-dom"</span> % <span style="color: #2d9574;">"0.9.1"</span>,
<span class="linenr">21: </span>      <span style="color: #2d9574;">"com.thoughtworks.binding"</span> %%% <span style="color: #2d9574;">"dom"</span> % <span style="color: #4e3163;">BindingScalaVersion</span>,
<span class="linenr">22: </span>      <span style="color: #2d9574;">"com.thoughtworks.binding"</span> %%% <span style="color: #2d9574;">"route"</span> % <span style="color: #4e3163;">BindingScalaVersion</span>
<span class="linenr">23: </span>    <span style="color: #6c3163;">)</span>
<span class="linenr">24: </span>  <span style="color: #3a81c3;">)</span>.
<span class="linenr">25: </span>  enablePlugins<span style="color: #3a81c3;">(</span><span style="color: #4e3163;">ScalaJSPlugin</span><span style="color: #3a81c3;">)</span>
</pre>
</div>

<p>
然后写一个 <code>Main</code> 函数。
</p>

<div class="org-src-container">
<pre class="src src-scala"><span class="linenr">1: </span><span style="color: #2aa1ae; background-color: #ecf3ec;">/* </span><span style="color: #2aa1ae; background-color: #ecf3ec;">js/src/main/scala/Application.scala */</span>
<span class="linenr">2: </span><span style="color: #3a81c3; font-weight: bold;">import</span> scala.scalajs.js.<span style="color: #4e3163;">JSApp</span>
<span class="linenr">3: </span>
<span class="linenr">4: </span><span style="color: #3a81c3; font-weight: bold;">object</span> <span style="color: #4e3163;">Application</span> <span style="color: #3a81c3; font-weight: bold;">extends</span> <span style="color: #ba2f59; font-weight: bold;">JSApp</span> <span style="color: #3a81c3;">{</span>
<span class="linenr">5: </span>  <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">main</span><span style="color: #6c3163;">()</span><span style="color: #3a81c3; font-weight: bold;">:</span> <span style="color: #ba2f59; font-weight: bold;">Unit</span> <span style="color: #3a81c3; font-weight: bold;">=</span> println<span style="color: #6c3163;">(</span><span style="color: #2d9574;">"Hello World!"</span><span style="color: #6c3163;">)</span>
<span class="linenr">6: </span><span style="color: #3a81c3;">}</span>
</pre>
</div>

<p>
至此一个最简单的 <code>scala.js</code> with <code>Binding.scala</code> 的工程已经搭建好了。
</p>

<p>
执行 <code>sbt fastOptJS</code>
</p>
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #3a81c3; font-weight: bold;">$</span> <span style="color: #4e3163; font-style: italic;">ls</span> js/target/scala-2.11
<span style="color: #2aa1ae; font-weight: bold;">classes</span>           js-fastopt.js     js-fastopt.js.map js-jsdeps.js      js-launcher.js
</pre>
</div>

<p>
在项目根目录下新建一个 <code>index.html</code> 
</p>
<div class="org-src-container">
<pre class="src src-html"><span class="linenr"> 1: </span><span style="color: #4e3163;">&lt;!doctype html&gt;</span>
<span class="linenr"> 2: </span>&lt;<span style="color: #3a81c3;">html</span>&gt;
<span class="linenr"> 3: </span>  &lt;<span style="color: #3a81c3;">head</span>&gt;
<span class="linenr"> 4: </span>    &lt;<span style="color: #3a81c3;">meta</span> <span style="color: #715ab1;">charset</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574;">"utf-8"</span>&gt;
<span class="linenr"> 5: </span>    &lt;<span style="color: #3a81c3;">meta</span> <span style="color: #715ab1;">http-equiv</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574;">"X-UA-Compatible"</span> <span style="color: #715ab1;">content</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574;">"IE=edge,chrome=1"</span>&gt;
<span class="linenr"> 6: </span>    &lt;<span style="color: #3a81c3;">meta</span> <span style="color: #715ab1;">name</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574;">"description"</span> <span style="color: #715ab1;">content</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574;">""</span>&gt;
<span class="linenr"> 7: </span>    &lt;<span style="color: #3a81c3;">meta</span> <span style="color: #715ab1;">name</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574;">"viewport"</span> <span style="color: #715ab1;">content</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574;">"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"</span>&gt;
<span class="linenr"> 8: </span>    &lt;<span style="color: #3a81c3;">title</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Hello World!</span>&lt;/<span style="color: #3a81c3;">title</span>&gt;
<span class="linenr"> 9: </span>    &lt;<span style="color: #3a81c3;">script</span> <span style="color: #715ab1;">type</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574;">"text/javascript"</span> <span style="color: #715ab1;">src</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574;">"./js/target/scala-2.11/js-jsdeps.js"</span>&gt;&lt;/<span style="color: #3a81c3;">script</span>&gt;
<span class="linenr">10: </span>    &lt;<span style="color: #3a81c3;">script</span> <span style="color: #715ab1;">type</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574;">"text/javascript"</span> <span style="color: #715ab1;">src</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574;">"./js/target/scala-2.11/js-fastopt.js"</span>&gt;&lt;/<span style="color: #3a81c3;">script</span>&gt;
<span class="linenr">11: </span>  &lt;/<span style="color: #3a81c3;">head</span>&gt;
<span class="linenr">12: </span>  &lt;<span style="color: #3a81c3;">body</span>&gt;
<span class="linenr">13: </span>    &lt;<span style="color: #3a81c3;">script</span> <span style="color: #715ab1;">type</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574;">"text/javascript"</span> <span style="color: #715ab1;">src</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574;">"./js/target/scala-2.11/js-launcher.js"</span>&gt;&lt;/<span style="color: #3a81c3;">script</span>&gt;
<span class="linenr">14: </span>  &lt;/<span style="color: #3a81c3;">body</span>&gt;
<span class="linenr">15: </span>&lt;/<span style="color: #3a81c3;">html</span>&gt;
</pre>
</div>

<p>
在浏览器中打开，就能看到我们亲切的 <code>Hello World!</code> 了。
</p>

<iframe height="300" frameborder="0" style="width: 100%; overflow: hidden;" src="https://embed.scalafiddle.io/embed?sfid=zKNO24v/0&theme=dark"></iframe>

<p>
然而一个真正的前端项目，不可能一直使用本地文件来验证查看的，所以我需要一个server。=Play= 和 <code>scalatra</code> 在这个场景中有点杀鸡用牛刀的感觉，所以我选择了 <code>Akka Http</code> 做这个 <code>webserver</code> 。
中间又出了点变故，本来打算用 <code>nginx</code> 伺服所有的静态文件的，后来深感线上虚拟机上搞一个nginx，还要搞个发布流程甚是麻烦。索性打成一个可以执行的jar，来的方便，一股脑地就把配置写好吧。
</p>

<div class="org-src-container">
<pre class="src src-scala"><span class="linenr"> 1: </span><span style="color: #3a81c3;">lazy</span> <span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">commonSettings</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #4e3163;">Seq</span><span style="color: #3a81c3;">(</span>
<span class="linenr"> 2: </span>  version := <span style="color: #2d9574;">"0.0.1"</span>,
<span class="linenr"> 3: </span>  scalaVersion := <span style="color: #2d9574;">"2.11.8"</span>,
<span class="linenr"> 4: </span>  addCompilerPlugin<span style="color: #6c3163;">(</span><span style="color: #2d9574;">"org.scalamacros"</span> % <span style="color: #2d9574;">"paradise"</span> % <span style="color: #2d9574;">"2.1.0"</span> cross <span style="color: #4e3163;">CrossVersion</span>.full<span style="color: #6c3163;">)</span>,
<span class="linenr"> 5: </span>  scalacOptions ++= <span style="color: #4e3163;">Seq</span><span style="color: #6c3163;">(</span><span style="color: #2d9574;">"-feature"</span>, <span style="color: #2d9574;">"-language:implicitConversions"</span><span style="color: #6c3163;">)</span>
<span class="linenr"> 6: </span><span style="color: #3a81c3;">)</span>
<span class="linenr"> 7: </span>
<span class="linenr"> 8: </span><span style="color: #3a81c3;">lazy</span> <span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">AkkaVersion</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574;">"2.4.16"</span>
<span class="linenr"> 9: </span>
<span class="linenr">10: </span><span style="color: #3a81c3;">lazy</span> <span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">AkkaHttpVersion</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574;">"10.0.1"</span>
<span class="linenr">11: </span>
<span class="linenr">12: </span><span style="color: #3a81c3;">lazy</span> <span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">BindingScalaVersion</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574;">"10.0.1"</span>
<span class="linenr">13: </span>
<span class="linenr">14: </span><span style="color: #3a81c3;">lazy</span> <span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">CirceVersion</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574;">"0.6.1"</span>
<span class="linenr">15: </span>
<span class="linenr">16: </span><span style="color: #3a81c3;">lazy</span> <span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">ScalazVersion</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574;">"7.2.8"</span>
<span class="linenr">17: </span>
<span class="linenr">18: </span><span style="color: #3a81c3;">lazy</span> <span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">compileCopyTask</span> <span style="color: #3a81c3; font-weight: bold;">=</span> taskKey<span style="color: #3a81c3;">[</span><span style="color: #4e3163;">Unit</span><span style="color: #3a81c3;">](</span><span style="color: #2d9574;">"compile and copy"</span><span style="color: #3a81c3;">)</span>
<span class="linenr">19: </span>
<span class="linenr">20: </span>
<span class="linenr">21: </span><span style="color: #3a81c3;">lazy</span> <span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">root</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #3a81c3;">(</span>project in file<span style="color: #6c3163;">(</span><span style="color: #2d9574;">"."</span><span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>.
<span class="linenr">22: </span>  settings<span style="color: #3a81c3;">(</span>commonSettings<span style="color: #3a81c3; font-weight: bold;">:</span> <span style="color: #3a81c3; font-weight: bold;">_</span>*<span style="color: #3a81c3;">)</span>.
<span class="linenr">23: </span>  aggregate<span style="color: #3a81c3;">(</span>server, js<span style="color: #3a81c3;">)</span>
<span class="linenr">24: </span>
<span class="linenr">25: </span><span style="color: #3a81c3;">lazy</span> <span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">server</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #3a81c3;">(</span>project in file<span style="color: #6c3163;">(</span><span style="color: #2d9574;">"server"</span><span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>.
<span class="linenr">26: </span>  settings<span style="color: #3a81c3;">(</span>commonSettings<span style="color: #3a81c3; font-weight: bold;">:</span> <span style="color: #3a81c3; font-weight: bold;">_</span>*<span style="color: #3a81c3;">)</span>.
<span class="linenr">27: </span>  settings<span style="color: #3a81c3;">(</span>
<span class="linenr">28: </span>    cancelable in <span style="color: #4e3163;">Global</span> := <span style="color: #4e3163;">true</span>,
<span class="linenr">29: </span>    fork in run := <span style="color: #4e3163;">true</span>,
<span class="linenr">30: </span>    libraryDependencies ++= <span style="color: #4e3163;">Seq</span><span style="color: #6c3163;">(</span>
<span class="linenr">31: </span>      <span style="color: #2d9574;">"com.typesafe.akka"</span> %% <span style="color: #2d9574;">"akka-actor"</span> % <span style="color: #4e3163;">AkkaVersion</span>,
<span class="linenr">32: </span>      <span style="color: #2d9574;">"com.typesafe.akka"</span> %% <span style="color: #2d9574;">"akka-stream"</span> % <span style="color: #4e3163;">AkkaVersion</span>,
<span class="linenr">33: </span>      <span style="color: #2d9574;">"com.typesafe.akka"</span> %% <span style="color: #2d9574;">"akka-http"</span> % <span style="color: #4e3163;">AkkaHttpVersion</span>,
<span class="linenr">34: </span>      <span style="color: #2d9574;">"ch.qos.logback"</span> %  <span style="color: #2d9574;">"logback-classic"</span> % <span style="color: #2d9574;">"1.1.7"</span>,
<span class="linenr">35: </span>      <span style="color: #2d9574;">"com.typesafe.scala-logging"</span> %% <span style="color: #2d9574;">"scala-logging"</span> % <span style="color: #2d9574;">"3.5.0"</span>
<span class="linenr">36: </span>    <span style="color: #6c3163;">)</span>
<span class="linenr">37: </span>  <span style="color: #3a81c3;">)</span>.
<span class="linenr">38: </span>  settings<span style="color: #3a81c3;">(</span>
<span class="linenr">39: </span>    compileCopyTask := <span style="color: #6c3163;">{</span>
<span class="linenr">40: </span>      <span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">mainVersion</span> <span style="color: #3a81c3; font-weight: bold;">=</span> scalaVersion.value.split<span style="color: #2d9574;">(</span><span style="color: #2d9574;">"""\."""</span><span style="color: #2d9574;">)</span>.take<span style="color: #2d9574;">(</span><span style="color: #4e3163;">2</span><span style="color: #2d9574;">)</span>.mkString<span style="color: #2d9574;">(</span><span style="color: #2d9574;">"."</span><span style="color: #2d9574;">)</span>
<span class="linenr">41: </span>      <span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">to</span> <span style="color: #3a81c3; font-weight: bold;">=</span> target.value / <span style="color: #2d9574;">(</span><span style="color: #2d9574;">"scala-"</span> + mainVersion<span style="color: #2d9574;">)</span> / <span style="color: #2d9574;">"classes"</span> / <span style="color: #2d9574;">"static"</span> / <span style="color: #2d9574;">"js"</span>
<span class="linenr">42: </span>      to.mkdirs<span style="color: #2d9574;">()</span>
<span class="linenr">43: </span>      <span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">fastJs</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574;">(</span>fastOptJS in <span style="color: #4e3163;">Compile</span> in js<span style="color: #2d9574;">)</span>.value.data
<span class="linenr">44: </span>      <span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">fastJsSourceMap</span> <span style="color: #3a81c3; font-weight: bold;">=</span> fastJs.getParentFile / <span style="color: #2d9574;">(</span>fastJs.getName + <span style="color: #2d9574;">".map"</span><span style="color: #2d9574;">)</span>
<span class="linenr">45: </span>      <span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">fastJsLauncher</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574;">(</span>packageScalaJSLauncher in <span style="color: #4e3163;">Compile</span> in js<span style="color: #2d9574;">)</span>.value.data
<span class="linenr">46: </span>      <span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">fastJsDeps</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574;">(</span>packageJSDependencies in <span style="color: #4e3163;">Compile</span> in js<span style="color: #2d9574;">)</span>.value
<span class="linenr">47: </span>      <span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">fullJs</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574;">(</span>fullOptJS in <span style="color: #4e3163;">Compile</span> in js<span style="color: #2d9574;">)</span>.value.data
<span class="linenr">48: </span>      <span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">fullJsSourceMap</span> <span style="color: #3a81c3; font-weight: bold;">=</span> fullJs.getParentFile / <span style="color: #2d9574;">(</span>fullJs.getName + <span style="color: #2d9574;">".map"</span><span style="color: #2d9574;">)</span>
<span class="linenr">49: </span>      <span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">fullJsDeps</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574;">(</span>packageMinifiedJSDependencies in <span style="color: #4e3163;">Compile</span> in js<span style="color: #2d9574;">)</span>.value
<span class="linenr">50: </span>
<span class="linenr">51: </span>      <span style="color: #3a81c3; font-weight: bold;">for</span><span style="color: #2d9574;">(</span>f <span style="color: #3a81c3; font-weight: bold;">&lt;-</span> <span style="color: #4e3163;">Seq</span><span style="color: #67b11d;">(</span>fastJs, fastJsSourceMap, fastJsLauncher, fastJsDeps, fullJs, fullJsSourceMap, fullJsDeps<span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span> <span style="color: #2d9574;">{</span>
<span class="linenr">52: </span>        <span style="color: #4e3163;">IO</span>.copyFile<span style="color: #67b11d;">(</span>f, to / f.getName<span style="color: #67b11d;">)</span>
<span class="linenr">53: </span>      <span style="color: #2d9574;">}</span>
<span class="linenr">54: </span>    <span style="color: #6c3163;">}</span>
<span class="linenr">55: </span>  <span style="color: #3a81c3;">)</span>.
<span class="linenr">56: </span>  settings<span style="color: #3a81c3;">(</span>
<span class="linenr">57: </span>    compile in <span style="color: #4e3163;">Compile</span> := <span style="color: #6c3163;">{</span>
<span class="linenr">58: </span>      compileCopyTask.value
<span class="linenr">59: </span>      <span style="color: #2d9574;">(</span>compile in <span style="color: #4e3163;">Compile</span><span style="color: #2d9574;">)</span>.value
<span class="linenr">60: </span>    <span style="color: #6c3163;">}</span>
<span class="linenr">61: </span>  <span style="color: #3a81c3;">)</span>.
<span class="linenr">62: </span>  settings<span style="color: #3a81c3;">(</span>
<span class="linenr">63: </span>    mainClass in assembly := <span style="color: #4e3163;">Some</span><span style="color: #6c3163;">(</span><span style="color: #2d9574;">"Server"</span><span style="color: #6c3163;">)</span>,
<span class="linenr">64: </span>    assemblyJarName in assembly := <span style="color: #2d9574;">"server.jar"</span>
<span class="linenr">65: </span>  <span style="color: #3a81c3;">)</span>
<span class="linenr">66: </span>
<span class="linenr">67: </span><span style="color: #3a81c3;">lazy</span> <span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">js</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #3a81c3;">(</span>project in file<span style="color: #6c3163;">(</span><span style="color: #2d9574;">"js"</span><span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>.
<span class="linenr">68: </span>  settings<span style="color: #3a81c3;">(</span>commonSettings<span style="color: #3a81c3; font-weight: bold;">:</span> <span style="color: #3a81c3; font-weight: bold;">_</span>*<span style="color: #3a81c3;">)</span>.
<span class="linenr">69: </span>  settings<span style="color: #3a81c3;">(</span>
<span class="linenr">70: </span>    mainClass in <span style="color: #6c3163;">(</span><span style="color: #4e3163;">Compile</span><span style="color: #6c3163;">)</span> := <span style="color: #4e3163;">Some</span><span style="color: #6c3163;">(</span><span style="color: #2d9574;">"Application"</span><span style="color: #6c3163;">)</span>,
<span class="linenr">71: </span>    persistLauncher := <span style="color: #4e3163;">true</span>,
<span class="linenr">72: </span>    libraryDependencies ++= <span style="color: #4e3163;">Seq</span><span style="color: #6c3163;">(</span>
<span class="linenr">73: </span>      <span style="color: #2d9574;">"org.scala-js"</span> %%% <span style="color: #2d9574;">"scalajs-dom"</span> % <span style="color: #2d9574;">"0.9.1"</span>,
<span class="linenr">74: </span>      <span style="color: #2d9574;">"com.thoughtworks.binding"</span> %%% <span style="color: #2d9574;">"dom"</span> % <span style="color: #4e3163;">BindingScalaVersion</span>,
<span class="linenr">75: </span>      <span style="color: #2d9574;">"com.thoughtworks.binding"</span> %%% <span style="color: #2d9574;">"route"</span> % <span style="color: #4e3163;">BindingScalaVersion</span>,
<span class="linenr">76: </span>      <span style="color: #2d9574;">"io.circe"</span> %%% <span style="color: #2d9574;">"circe-core"</span> % <span style="color: #4e3163;">CirceVersion</span>,
<span class="linenr">77: </span>      <span style="color: #2d9574;">"io.circe"</span> %%% <span style="color: #2d9574;">"circe-parser"</span> % <span style="color: #4e3163;">CirceVersion</span>,
<span class="linenr">78: </span>      <span style="color: #2d9574;">"io.circe"</span> %%% <span style="color: #2d9574;">"circe-generic"</span> % <span style="color: #4e3163;">CirceVersion</span>,
<span class="linenr">79: </span>      <span style="color: #2d9574;">"org.scalaz"</span> %%% <span style="color: #2d9574;">"scalaz-core"</span> % <span style="color: #4e3163;">ScalazVersion</span>
<span class="linenr">80: </span>    <span style="color: #6c3163;">)</span>
<span class="linenr">81: </span>  <span style="color: #3a81c3;">)</span>.
<span class="linenr">82: </span>  enablePlugins<span style="color: #3a81c3;">(</span><span style="color: #4e3163;">ScalaJSPlugin</span><span style="color: #3a81c3;">)</span>
<span class="linenr">83: </span>
</pre>
</div>

<p>
增加 <code>server</code> submodule
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #2aa1ae; font-weight: bold;">mkdir</span> <span style="color: #4e3163;">-p</span> server/src/<span style="color: #3a81c3;">{</span>main,test<span style="color: #3a81c3;">}</span>/<span style="color: #3a81c3;">{</span>scala,resources<span style="color: #3a81c3;">}</span>
</pre>
</div>

<p>
增加 <code>Server.scala</code>
</p>

<div class="org-src-container">
<pre class="src src-scala"><span class="linenr"> 1: </span><span style="color: #3a81c3; font-weight: bold;">import</span> java.util.concurrent.<span style="color: #4e3163;">CountDownLatch</span>
<span class="linenr"> 2: </span><span style="color: #3a81c3; font-weight: bold;">import</span> akka.actor.<span style="color: #4e3163;">ActorSystem</span>
<span class="linenr"> 3: </span><span style="color: #3a81c3; font-weight: bold;">import</span> akka.stream.<span style="color: #4e3163;">ActorMaterializer</span>
<span class="linenr"> 4: </span><span style="color: #3a81c3; font-weight: bold;">import</span> akka.http.scaladsl.<span style="color: #4e3163;">Http</span>
<span class="linenr"> 5: </span><span style="color: #3a81c3; font-weight: bold;">import</span> akka.http.scaladsl.server.<span style="color: #4e3163;">Directives</span>.<span style="color: #3a81c3; font-weight: bold;">_</span>
<span class="linenr"> 6: </span><span style="color: #3a81c3; font-weight: bold;">import</span> com.typesafe.config.<span style="color: #4e3163;">ConfigFactory</span>
<span class="linenr"> 7: </span><span style="color: #3a81c3; font-weight: bold;">import</span> com.typesafe.scalalogging.<span style="color: #4e3163;">Logger</span>
<span class="linenr"> 8: </span><span style="color: #3a81c3; font-weight: bold;">import</span> scala.concurrent.<span style="color: #4e3163;">Await</span>
<span class="linenr"> 9: </span><span style="color: #3a81c3; font-weight: bold;">import</span> scala.concurrent.duration.<span style="color: #3a81c3; font-weight: bold;">_</span>
<span class="linenr">10: </span>
<span class="linenr">11: </span><span style="color: #3a81c3; font-weight: bold;">object</span> <span style="color: #4e3163;">Server</span> <span style="color: #3a81c3; font-weight: bold;">extends</span> <span style="color: #ba2f59; font-weight: bold;">App</span> <span style="color: #3a81c3;">{</span>
<span class="linenr">12: </span>  <span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">logger</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #4e3163;">Logger</span><span style="color: #6c3163;">(</span><span style="color: #4e3163;">Server</span>.getClass<span style="color: #6c3163;">)</span>
<span class="linenr">13: </span>  <span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">conf</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #4e3163;">ConfigFactory</span>.load<span style="color: #6c3163;">()</span>.withFallback<span style="color: #6c3163;">(</span><span style="color: #4e3163;">ConfigFactory</span>.load<span style="color: #2d9574;">(</span><span style="color: #2d9574;">"default.conf"</span><span style="color: #2d9574;">)</span><span style="color: #6c3163;">)</span>
<span class="linenr">14: </span>
<span class="linenr">15: </span>  <span style="color: #3a81c3;">implicit</span> <span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">actorSystem</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #4e3163;">ActorSystem</span><span style="color: #6c3163;">()</span>
<span class="linenr">16: </span>  <span style="color: #3a81c3;">implicit</span> <span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">materializer</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #4e3163;">ActorMaterializer</span><span style="color: #6c3163;">()</span>
<span class="linenr">17: </span>  <span style="color: #3a81c3;">implicit</span> <span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">executionContext</span> <span style="color: #3a81c3; font-weight: bold;">=</span> actorSystem.dispatcher
<span class="linenr">18: </span>
<span class="linenr">19: </span>  <span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">shutdownLatch</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #3a81c3; font-weight: bold;">new</span> <span style="color: #ba2f59; font-weight: bold;">CountDownLatch</span><span style="color: #6c3163;">(</span><span style="color: #4e3163;">1</span><span style="color: #6c3163;">)</span>
<span class="linenr">20: </span>
<span class="linenr">21: </span>  <span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">devRoute</span> <span style="color: #3a81c3; font-weight: bold;">=</span> pathSingleSlash <span style="color: #6c3163;">{</span>
<span class="linenr">22: </span>    parameter<span style="color: #2d9574;">(</span><span style="color: #2d9574;">"fast"</span><span style="color: #2d9574;">)</span> <span style="color: #2d9574;">{</span> <span style="color: #3a81c3; font-weight: bold;">_</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span>
<span class="linenr">23: </span>      getFromFile<span style="color: #67b11d;">(</span><span style="color: #2d9574;">"./src/main/resources/static/index-fastopt.html"</span><span style="color: #67b11d;">)</span>
<span class="linenr">24: </span>    <span style="color: #2d9574;">}</span> ~
<span class="linenr">25: </span>      getFromFile<span style="color: #2d9574;">(</span><span style="color: #2d9574;">"./src/main/resources/static/index-fullopt.html"</span><span style="color: #2d9574;">)</span>
<span class="linenr">26: </span>  <span style="color: #6c3163;">}</span> ~
<span class="linenr">27: </span>    encodeResponse <span style="color: #6c3163;">{</span>
<span class="linenr">28: </span>      getFromDirectory<span style="color: #2d9574;">(</span><span style="color: #2d9574;">"./src/main/resources/static"</span><span style="color: #2d9574;">)</span> ~
<span class="linenr">29: </span>        pathPrefix<span style="color: #2d9574;">(</span><span style="color: #2d9574;">"js"</span><span style="color: #2d9574;">)</span> <span style="color: #2d9574;">{</span>
<span class="linenr">30: </span>          getFromDirectory<span style="color: #67b11d;">(</span><span style="color: #2d9574;">"../js/target/scala-2.11"</span><span style="color: #67b11d;">)</span>
<span class="linenr">31: </span>        <span style="color: #2d9574;">}</span>
<span class="linenr">32: </span>    <span style="color: #6c3163;">}</span>
<span class="linenr">33: </span>
<span class="linenr">34: </span>  <span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">productionRoute</span> <span style="color: #3a81c3; font-weight: bold;">=</span> pathSingleSlash <span style="color: #6c3163;">{</span>
<span class="linenr">35: </span>    parameter<span style="color: #2d9574;">(</span><span style="color: #2d9574;">"fast"</span><span style="color: #2d9574;">)</span> <span style="color: #2d9574;">{</span> <span style="color: #3a81c3; font-weight: bold;">_</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span>
<span class="linenr">36: </span>      getFromResource<span style="color: #67b11d;">(</span><span style="color: #2d9574;">"static/index-fastopt.html"</span><span style="color: #67b11d;">)</span>
<span class="linenr">37: </span>    <span style="color: #2d9574;">}</span> ~
<span class="linenr">38: </span>      getFromResource<span style="color: #2d9574;">(</span><span style="color: #2d9574;">"static/index-fullopt.html"</span><span style="color: #2d9574;">)</span>
<span class="linenr">39: </span>  <span style="color: #6c3163;">}</span> ~
<span class="linenr">40: </span>    encodeResponse <span style="color: #6c3163;">{</span>
<span class="linenr">41: </span>      getFromResourceDirectory<span style="color: #2d9574;">(</span><span style="color: #2d9574;">"static"</span><span style="color: #2d9574;">)</span>
<span class="linenr">42: </span>    <span style="color: #6c3163;">}</span>
<span class="linenr">43: </span>
<span class="linenr">44: </span>  <span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">host</span> <span style="color: #3a81c3; font-weight: bold;">=</span> conf.getString<span style="color: #6c3163;">(</span><span style="color: #2d9574;">"server.host"</span><span style="color: #6c3163;">)</span>
<span class="linenr">45: </span>  <span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">port</span> <span style="color: #3a81c3; font-weight: bold;">=</span> conf.getInt<span style="color: #6c3163;">(</span><span style="color: #2d9574;">"server.port"</span><span style="color: #6c3163;">)</span>
<span class="linenr">46: </span>  <span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">bindingFuture</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #4e3163;">Http</span><span style="color: #6c3163;">()</span>.bindAndHandle<span style="color: #6c3163;">(</span>devRoute ~ productionRoute, host, port<span style="color: #6c3163;">)</span>
<span class="linenr">47: </span>  logger.info<span style="color: #6c3163;">(</span>s<span style="color: #2d9574;">"Server online as http://</span><span style="color: #715ab1;">${host}</span><span style="color: #2d9574;">:</span><span style="color: #715ab1;">${port}</span><span style="color: #2d9574;">"</span><span style="color: #6c3163;">)</span>
<span class="linenr">48: </span>
<span class="linenr">49: </span>  <span style="color: #4e3163;">Runtime</span>.getRuntime<span style="color: #6c3163;">()</span>.addShutdownHook<span style="color: #6c3163;">(</span><span style="color: #3a81c3; font-weight: bold;">new</span> <span style="color: #ba2f59; font-weight: bold;">Thread</span><span style="color: #2d9574;">()</span> <span style="color: #2d9574;">{</span>
<span class="linenr">50: </span>    <span style="color: #3a81c3;">override</span> <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">run</span><span style="color: #67b11d;">()</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #67b11d;">{</span>
<span class="linenr">51: </span>      <span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">f</span> <span style="color: #3a81c3; font-weight: bold;">=</span> bindingFuture.flatMap<span style="color: #b1951d;">(</span><span style="color: #3a81c3; font-weight: bold;">_</span>.unbind<span style="color: #3a81c3;">()</span><span style="color: #b1951d;">)</span> andThen <span style="color: #b1951d;">{</span>
<span class="linenr">52: </span>        <span style="color: #3a81c3; font-weight: bold;">case</span> <span style="color: #3a81c3; font-weight: bold;">_</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span> actorSystem.terminate<span style="color: #3a81c3;">()</span>
<span class="linenr">53: </span>      <span style="color: #b1951d;">}</span>
<span class="linenr">54: </span>      <span style="color: #4e3163;">Await</span>.ready<span style="color: #b1951d;">(</span>f, <span style="color: #4e3163;">1</span> minute<span style="color: #b1951d;">)</span>
<span class="linenr">55: </span>      logger.info<span style="color: #b1951d;">(</span><span style="color: #2d9574;">"Goodbye!"</span><span style="color: #b1951d;">)</span>
<span class="linenr">56: </span>      shutdownLatch.countDown<span style="color: #b1951d;">()</span>
<span class="linenr">57: </span>    <span style="color: #67b11d;">}</span>
<span class="linenr">58: </span>  <span style="color: #2d9574;">}</span><span style="color: #6c3163;">)</span>
<span class="linenr">59: </span>
<span class="linenr">60: </span>  shutdownLatch.await<span style="color: #6c3163;">()</span>
<span class="linenr">61: </span><span style="color: #3a81c3;">}</span>
</pre>
</div>

<p>
现在只要执行，=sbt server/run= ，然后在浏览器中访问 <code>http://127.0.0.1:1234/?fast</code> 或者 <code>http://127.0.0.1:1234/</code> 就能分别访问 <code>fastOptJS</code> 或者 <code>fullOptJS</code> 的js了。
</p>

<p>
好了这只是一个准备工作，接下来是 <code>Binding.scala</code> 的哲学时间。
</p>

<p>
<code>Binding.scala</code> 给我的第一印象不是 类似 <code>react.js</code> 的xml语法糖，而是 <code>mvvm</code> 中的经典js库 <a href="http://knockoutjs.com/documentation/introduction.html">knockout</a> 。=knockout= 的官方文档中开篇就介绍了，=knockout= 的特性。
</p>

<blockquote>
<ul class="org-ul">
<li><b>Elegant dependency tracking</b> - automatically updates the right parts of your UI whenever your data model changes.</li>
<li><b>Declarative bindings</b> - a simple and obvious way to connect parts of your UI to your data model. You can construct a complex dynamic UIs easily using arbitrarily nested binding contexts.</li>
<li><b>Trivially extensible</b> - implement custom behaviors as new declarative bindings for easy reuse in just a few lines of code.</li>
</ul>
</blockquote>

<p>
看一段 <code>knockout</code> 文档中的一小撮代码。
</p>

<div class="org-src-container">
<pre class="src src-javascript"><span class="linenr">1: </span><span style="color: #3a81c3; font-weight: bold;">function</span> <span style="color: #ba2f59; font-weight: bold;">AppViewModel</span><span style="color: #3a81c3; background-color: #fbf8ef;">()</span> <span style="color: #3a81c3; background-color: #fbf8ef;">{</span>
<span class="linenr">2: </span>  <span style="color: #3a81c3;">this</span><span style="color: #655370; background-color: #fbf8ef;">.</span><span style="color: #715ab1; font-style: italic;">firstName</span> <span style="color: #3a81c3; font-weight: bold;">=</span> ko<span style="color: #655370; background-color: #fbf8ef;">.</span><span style="color: #2aa1ae; font-weight: bold; font-style: italic;">observable</span><span style="color: #6c3163; background-color: #fbf8ef;">(</span><span style="color: #2d9574;">'Bob'</span><span style="color: #6c3163; background-color: #fbf8ef;">)</span><span style="color: #655370; background-color: #fbf8ef;">;</span>
<span class="linenr">3: </span>  <span style="color: #3a81c3;">this</span><span style="color: #655370; background-color: #fbf8ef;">.</span><span style="color: #715ab1; font-style: italic;">lastName</span> <span style="color: #3a81c3; font-weight: bold;">=</span> ko<span style="color: #655370; background-color: #fbf8ef;">.</span><span style="color: #2aa1ae; font-weight: bold; font-style: italic;">observable</span><span style="color: #6c3163; background-color: #fbf8ef;">(</span><span style="color: #2d9574;">'Smith'</span><span style="color: #6c3163; background-color: #fbf8ef;">)</span><span style="color: #655370; background-color: #fbf8ef;">;</span>
<span class="linenr">4: </span>
<span class="linenr">5: </span>  <span style="color: #3a81c3;">this</span><span style="color: #655370; background-color: #fbf8ef;">.</span><span style="color: #715ab1; font-style: italic;">fullName</span> <span style="color: #3a81c3; font-weight: bold;">=</span> ko<span style="color: #655370; background-color: #fbf8ef;">.</span><span style="color: #2aa1ae; font-weight: bold; font-style: italic;">computed</span><span style="color: #6c3163; background-color: #fbf8ef;">(</span><span style="color: #3a81c3; font-weight: bold;">function</span><span style="color: #2d9574; background-color: #fbf8ef;">()</span> <span style="color: #2d9574; background-color: #fbf8ef;">{</span>
<span class="linenr">6: </span>    <span style="color: #3a81c3; font-weight: bold;">return</span> <span style="color: #3a81c3;">this</span><span style="color: #655370; background-color: #fbf8ef;">.</span><span style="color: #2aa1ae; font-weight: bold; font-style: italic;">firstName</span><span style="color: #67b11d; background-color: #fbf8ef;">()</span> <span style="color: #3a81c3; font-weight: bold;">+</span> <span style="color: #2d9574;">" "</span> <span style="color: #3a81c3; font-weight: bold;">+</span> <span style="color: #3a81c3;">this</span><span style="color: #655370; background-color: #fbf8ef;">.</span><span style="color: #2aa1ae; font-weight: bold; font-style: italic;">lastName</span><span style="color: #67b11d; background-color: #fbf8ef;">()</span><span style="color: #655370; background-color: #fbf8ef;">;</span>
<span class="linenr">7: </span>  <span style="color: #2d9574; background-color: #fbf8ef;">}</span><span style="color: #655370; background-color: #fbf8ef;">,</span> <span style="color: #3a81c3;">this</span><span style="color: #6c3163; background-color: #fbf8ef;">)</span><span style="color: #655370; background-color: #fbf8ef;">;</span>
<span class="linenr">8: </span><span style="color: #3a81c3; background-color: #fbf8ef;">}</span>
</pre>
</div>

<p>
这里在 <code>AppViewModel</code> 中定义了两个 <code>observable</code> 属性 <code>firstName</code> 和 <code>lastName</code> ，以及一个计算属性 <code>fullName</code> ， 换句话说，=fullName= 依赖于 <code>firstName</code> 和 <code>lastName</code> 。下面用 <code>Binding.scala</code> 来实现这个逻辑。
</p>

<div class="org-src-container">
<pre class="src src-scala"><span class="linenr">1: </span><span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">firstName</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #4e3163;">Var</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">"Shane"</span><span style="color: #3a81c3;">)</span>
<span class="linenr">2: </span><span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">lastName</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #4e3163;">Var</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">"Xu"</span><span style="color: #3a81c3;">)</span>
<span class="linenr">3: </span>
<span class="linenr">4: </span><span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">fullName</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #4e3163;">Binding</span> <span style="color: #3a81c3;">{</span>
<span class="linenr">5: </span>  s<span style="color: #2d9574;">"</span><span style="color: #715ab1;">${firstName.bind}</span><span style="color: #2d9574;"> </span><span style="color: #715ab1;">${lastName.bind}</span><span style="color: #2d9574;">"</span>
<span class="linenr">6: </span><span style="color: #3a81c3;">}</span>
</pre>
</div>

<iframe height="300" frameborder="0" style="width: 100%; overflow: hidden;" src="https://embed.scalafiddle.io/embed?sfid=GcSSXpa/2&theme=dark"></iframe>

<p>
和 <code>knockout</code> 类似，=Binding.scala= 代码片段中的 <code>fullName</code> 也会随着 <code>firstName</code> 和 <code>lastName</code> 的变化而变化。
</p>

<p>
<code>Binding.scala</code> 第二印象，才是 <code>react.js</code> 。这主要归因于 <code>Binding.scala</code> 利用了 <code>scala</code> 原生的 <code>xml</code> 库，=scala= 是能直接在代码里面写 <code>xml</code> 的。然后利用宏来把 <code>xml</code> 转化成 <code>Node</code> 。
</p>


<p>
好吧回归主题, <code>Binding.scala in Practice</code> ，不知道Binding.scala的作者杨博，有没有在生产中使用过Binding.scala。为了写现在这篇文章我又翻出了杨博的 <a href="http://www.infoq.com/cn/articles/more-than-react-part01">More than React</a> 看了遍。其实有些观点，我不太认同。尤其是系列的第三篇 <code>More than React（二）组件对复用性有害？</code> ，其中有一句话：
</p>

<blockquote>
<p>
Binding.scala 不发明“组件”之类的噱头，而以更轻巧的“方法”为最小复用单位，让编程体验更加顺畅，获得了更好的代码复用性。
</p>
</blockquote>

<p>
有点“为赋新词”的味道。我不认为在基于html的前端编码中，“方法”作为最小的复用单位能提高效率。在目前为止我接触过的所有前端框架中，无论angular、react、knockout，最难解决的问题还是复用。我不知道项目越来越复杂，代码量越来越大杨博会如何组织代码。载我看来，按照组件去组织代码是最为清晰的。比如，在文章中举例的标签编辑器。原文中的代码如下：
</p>

<div class="org-src-container">
<pre class="src src-scala"><span class="linenr"> 1: </span><span style="color: #6c3163;">@dom</span> <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">tagPicker</span><span style="color: #3a81c3;">(</span>tags<span style="color: #3a81c3; font-weight: bold;">:</span> <span style="color: #ba2f59; font-weight: bold;">Vars</span><span style="color: #6c3163;">[</span><span style="color: #4e3163;">String</span><span style="color: #6c3163;">]</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #3a81c3;">{</span>
<span class="linenr"> 2: </span>  <span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">input</span><span style="color: #3a81c3; font-weight: bold;">:</span> <span style="color: #ba2f59; font-weight: bold;">Input</span> <span style="color: #3a81c3; font-weight: bold;">=</span> &lt;input <span style="color: #3a81c3; font-weight: bold;">type=</span><span style="color: #2d9574;">"text"</span>/&gt;
<span class="linenr"> 3: </span>  <span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">addHandler</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #6c3163;">{</span> event<span style="color: #3a81c3; font-weight: bold;">:</span> <span style="color: #ba2f59; font-weight: bold;">Event</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span>
<span class="linenr"> 4: </span>    <span style="color: #3a81c3; font-weight: bold;">if</span> <span style="color: #2d9574;">(</span>input.value != <span style="color: #2d9574;">""</span> &amp;&amp; !tags.get.contains<span style="color: #67b11d;">(</span>input.value<span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span> <span style="color: #2d9574;">{</span>
<span class="linenr"> 5: </span>      tags.get += input.value
<span class="linenr"> 6: </span>      input.value <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574;">""</span>
<span class="linenr"> 7: </span>    <span style="color: #2d9574;">}</span>
<span class="linenr"> 8: </span>  <span style="color: #6c3163;">}</span>
<span class="linenr"> 9: </span>  &lt;section&gt;
<span class="linenr">10: </span>    &lt;div&gt;<span style="color: #6c3163;">{</span>
<span class="linenr">11: </span>      <span style="color: #3a81c3; font-weight: bold;">for</span> <span style="color: #2d9574;">(</span>tag <span style="color: #3a81c3; font-weight: bold;">&lt;-</span> tags<span style="color: #2d9574;">)</span> <span style="color: #3a81c3; font-weight: bold;">yield</span> &lt;q&gt;
<span class="linenr">12: </span>        <span style="color: #2d9574;">{</span> tag <span style="color: #2d9574;">}</span>
<span class="linenr">13: </span>        &lt;button onclick<span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574;">{</span> event<span style="color: #3a81c3; font-weight: bold;">:</span> <span style="color: #ba2f59; font-weight: bold;">Event</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span> tags.get -= tag <span style="color: #2d9574;">}</span>&gt;x&lt;/button&gt;
<span class="linenr">14: </span>      &lt;/q&gt;
<span class="linenr">15: </span>    <span style="color: #6c3163;">}</span>&lt;/div&gt;
<span class="linenr">16: </span>    &lt;div&gt;<span style="color: #6c3163;">{</span> input <span style="color: #6c3163;">}</span> &lt;button onclick<span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #6c3163;">{</span> addHandler <span style="color: #6c3163;">}</span>&gt;<span style="color: #4e3163;">Add</span>&lt;/button&gt;&lt;/div&gt;
<span class="linenr">17: </span>  &lt;/section&gt;
<span class="linenr">18: </span><span style="color: #3a81c3;">}</span>
</pre>
</div>

<p>
我不知道，杨博是有意还是无意地一直在追求代码的行数。这段代码的确比DHTML和React的例子来的逻辑清晰。然而我想问的是，如果我某天想换一种展示方式，比如想把input控件换成select控件，又或者标签想用select来展示，那么上面的代码几乎就是废了。我曾经有幸接触过WPF（窃以为C#是我目前接触过的所有编程语言中，用户体验最好的语言，只可惜血统不好）。在WPF中小到一个Button都可以重写外观。比如，下面这个我随手摘来的栗子 <a href="https://www.tutorialspoint.com/wpf/wpf_templates.htm">https://www.tutorialspoint.com/wpf/wpf_templates.htm</a> 。
</p>

<div class="org-src-container">
<pre class="src src-xml"><span class="linenr"> 1: </span><span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">Window</span> <span style="color: #3a81c3; font-style: italic;">x</span><span style="color: #4e3163; font-style: italic;">:</span><span style="color: #715ab1; font-style: italic;">Class</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">TemplateDemo.MainWindow</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> 
<span class="linenr"> 2: </span>   <span style="color: #3a81c3; font-style: italic;">xmlns</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">http://schemas.microsoft.com/winfx/2006/xaml/presentation</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> 
<span class="linenr"> 3: </span>   <span style="color: #3a81c3; font-style: italic;">xmlns</span><span style="color: #4e3163; font-style: italic;">:</span><span style="color: #715ab1; font-style: italic;">x</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">http://schemas.microsoft.com/winfx/2006/xaml</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> 
<span class="linenr"> 4: </span>   <span style="color: #715ab1; font-style: italic;">Title</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">MainWindow</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">Height</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">350</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">Width</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">604</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span> 
<span class="linenr"> 5: </span>  
<span class="linenr"> 6: </span>   <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">Window.Resources</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span> 
<span class="linenr"> 7: </span>      <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">ControlTemplate</span> <span style="color: #3a81c3; font-style: italic;">x</span><span style="color: #4e3163; font-style: italic;">:</span><span style="color: #715ab1; font-style: italic;">Key</span><span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">ButtonTemplate</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">TargetType</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">Button</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span>
<span class="linenr"> 8: </span>    
<span class="linenr"> 9: </span>         <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">Grid</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span> 
<span class="linenr">10: </span>            <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">Ellipse</span> <span style="color: #3a81c3; font-style: italic;">x</span><span style="color: #4e3163; font-style: italic;">:</span><span style="color: #715ab1; font-style: italic;">Name</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">ButtonEllipse</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">Height</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">100</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">Width</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">150</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #655370; background-color: #fbf8ef;">&gt;</span> 
<span class="linenr">11: </span>               <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">Ellipse.Fill</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span> 
<span class="linenr">12: </span>                  <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">LinearGradientBrush</span> <span style="color: #715ab1; font-style: italic;">StartPoint</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">0,0.2</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">EndPoint</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">0.2,1.4</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span> 
<span class="linenr">13: </span>                     <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">GradientStop</span> <span style="color: #715ab1; font-style: italic;">Offset</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">0</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">Color</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">Red</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span> 
<span class="linenr">14: </span>                     <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">GradientStop</span> <span style="color: #715ab1; font-style: italic;">Offset</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">1</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">Color</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">Orange</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span> 
<span class="linenr">15: </span>                  <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #6c3163; font-weight: bold;">LinearGradientBrush</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span> 
<span class="linenr">16: </span>               <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #6c3163; font-weight: bold;">Ellipse.Fill</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span> 
<span class="linenr">17: </span>            <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #6c3163; font-weight: bold;">Ellipse</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span> 
<span class="linenr">18: </span>        
<span class="linenr">19: </span>            <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">ContentPresenter</span> <span style="color: #715ab1; font-style: italic;">Content</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">{TemplateBinding Content}</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> 
<span class="linenr">20: </span>               <span style="color: #715ab1; font-style: italic;">HorizontalAlignment</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">Center</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">VerticalAlignment</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">Center</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span> 
<span class="linenr">21: </span>         <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #6c3163; font-weight: bold;">Grid</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span> 
<span class="linenr">22: </span>      
<span class="linenr">23: </span>         <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">ControlTemplate.Triggers</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span> 
<span class="linenr">24: </span>      
<span class="linenr">25: </span>            <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">Trigger</span> <span style="color: #715ab1; font-style: italic;">Property</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">IsMouseOver</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">Value</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">True</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span> 
<span class="linenr">26: </span>               <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">Setter</span> <span style="color: #715ab1; font-style: italic;">TargetName</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">ButtonEllipse</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">Property</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">Fill</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #655370; background-color: #fbf8ef;">&gt;</span> 
<span class="linenr">27: </span>                  <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">Setter.Value</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span> 
<span class="linenr">28: </span>                     <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">LinearGradientBrush</span> <span style="color: #715ab1; font-style: italic;">StartPoint</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">0,0.2</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">EndPoint</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">0.2,1.4</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span> 
<span class="linenr">29: </span>                        <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">GradientStop</span> <span style="color: #715ab1; font-style: italic;">Offset</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">0</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">Color</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">YellowGreen</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span> 
<span class="linenr">30: </span>                        <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">GradientStop</span> <span style="color: #715ab1; font-style: italic;">Offset</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">1</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">Color</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">Gold</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span> 
<span class="linenr">31: </span>                     <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #6c3163; font-weight: bold;">LinearGradientBrush</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span> 
<span class="linenr">32: </span>                  <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #6c3163; font-weight: bold;">Setter.Value</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span> 
<span class="linenr">33: </span>               <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #6c3163; font-weight: bold;">Setter</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span> 
<span class="linenr">34: </span>            <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #6c3163; font-weight: bold;">Trigger</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span> 
<span class="linenr">35: </span>        
<span class="linenr">36: </span>            <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">Trigger</span> <span style="color: #715ab1; font-style: italic;">Property</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">IsPressed</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">Value</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">True</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span> 
<span class="linenr">37: </span>               <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">Setter</span> <span style="color: #715ab1; font-style: italic;">Property</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">RenderTransform</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span> 
<span class="linenr">38: </span>                  <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">Setter.Value</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span> 
<span class="linenr">39: </span>                     <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">ScaleTransform</span> <span style="color: #715ab1; font-style: italic;">ScaleX</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">0.8</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">ScaleY</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">0.8</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> 
<span class="linenr">40: </span>                        <span style="color: #715ab1; font-style: italic;">CenterX</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">0</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">CenterY</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">0</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span>  <span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span> 
<span class="linenr">41: </span>                  <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #6c3163; font-weight: bold;">Setter.Value</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span> 
<span class="linenr">42: </span>               <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #6c3163; font-weight: bold;">Setter</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span> 
<span class="linenr">43: </span>               <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">Setter</span> <span style="color: #715ab1; font-style: italic;">Property</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">RenderTransformOrigin</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">Value</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">0.5,0.5</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span> 
<span class="linenr">44: </span>            <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #6c3163; font-weight: bold;">Trigger</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span> 
<span class="linenr">45: </span>        
<span class="linenr">46: </span>         <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #6c3163; font-weight: bold;">ControlTemplate.Triggers</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span> 
<span class="linenr">47: </span>      
<span class="linenr">48: </span>      <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #6c3163; font-weight: bold;">ControlTemplate</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span> 
<span class="linenr">49: </span>   <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #6c3163; font-weight: bold;">Window.Resources</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span> 
<span class="linenr">50: </span>  
<span class="linenr">51: </span>   <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">StackPanel</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span> 
<span class="linenr">52: </span>      <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">Button</span> <span style="color: #715ab1; font-style: italic;">Content</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">Round Button!</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span>
<span class="linenr">53: </span>         <span style="color: #715ab1; font-style: italic;">Template</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">{StaticResource ButtonTemplate}</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> 
<span class="linenr">54: </span>         <span style="color: #715ab1; font-style: italic;">Width</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">150</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">Margin</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">50</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span> 
<span class="linenr">55: </span>      <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">Button</span> <span style="color: #715ab1; font-style: italic;">Content</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">Default Button!</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">Height</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">40</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> 
<span class="linenr">56: </span>         <span style="color: #715ab1; font-style: italic;">Width</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">150</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">Margin</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">5</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span>
<span class="linenr">57: </span>   <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #6c3163; font-weight: bold;">StackPanel</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span> 
<span class="linenr">58: </span>  
<span class="linenr">59: </span><span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #6c3163; font-weight: bold;">Window</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span> 
</pre>
</div>

<p>
Window.Resources标签中，定义了一个适用于Button的ControlTemplate，然后下面的StackPanel里面就塞了两个Button，上面那个是自定的，下面那个是正常的。而那个自定义的Button同样能够相应用户的点击事件，在用户看来，只是一个长得比较奇怪的Button。Button所有的内部逻辑，都和原先的Default的button一致。
也许你觉得这里，对一个Button，做了完全定义未免太小题大作了。然而举一个更有意思的例子，也许你就不会这么想了。
</p>

<p>
如果你所见的控件并不是你想象中的东西。
</p>

<div class="org-src-container">
<pre class="src src-xml"><span class="linenr"> 1: </span><span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">LinearGradientBrush</span> <span style="color: #3a81c3; font-style: italic;">x</span><span style="color: #4e3163; font-style: italic;">:</span><span style="color: #715ab1; font-style: italic;">Key</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">TabItemHotBackground</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">EndPoint</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">0,1</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">StartPoint</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">0,0</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span>
<span class="linenr"> 2: </span>    <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">GradientStop</span> <span style="color: #715ab1; font-style: italic;">Color</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">#EAF6FD</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">Offset</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">0.15</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span>
<span class="linenr"> 3: </span>    <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">GradientStop</span> <span style="color: #715ab1; font-style: italic;">Color</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">#D9F0FC</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">Offset</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">.5</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span>
<span class="linenr"> 4: </span>    <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">GradientStop</span> <span style="color: #715ab1; font-style: italic;">Color</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">#BEE6FD</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">Offset</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">.5</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span>
<span class="linenr"> 5: </span>    <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">GradientStop</span> <span style="color: #715ab1; font-style: italic;">Color</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">#A7D9F5</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">Offset</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">1</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span>
<span class="linenr"> 6: </span><span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #6c3163; font-weight: bold;">LinearGradientBrush</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span>
<span class="linenr"> 7: </span><span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">SolidColorBrush</span> <span style="color: #3a81c3; font-style: italic;">x</span><span style="color: #4e3163; font-style: italic;">:</span><span style="color: #715ab1; font-style: italic;">Key</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">TabItemSelectedBackground</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">Color</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">#F9F9F9</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span>
<span class="linenr"> 8: </span><span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">SolidColorBrush</span> <span style="color: #3a81c3; font-style: italic;">x</span><span style="color: #4e3163; font-style: italic;">:</span><span style="color: #715ab1; font-style: italic;">Key</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">TabItemHotBorderBrush</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">Color</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">#3C7FB1</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span>
<span class="linenr"> 9: </span>
<span class="linenr">10: </span><span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">Style</span> <span style="color: #3a81c3; font-style: italic;">x</span><span style="color: #4e3163; font-style: italic;">:</span><span style="color: #715ab1; font-style: italic;">Key</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">RadioButtonStyle1</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">TargetType</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">{x:Type RadioButton}</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span>
<span class="linenr">11: </span>    <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">Setter</span> <span style="color: #715ab1; font-style: italic;">Property</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">Template</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span>
<span class="linenr">12: </span>        <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">Setter.Value</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span>
<span class="linenr">13: </span>            <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">ControlTemplate</span> <span style="color: #715ab1; font-style: italic;">TargetType</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">RadioButton</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span>
<span class="linenr">14: </span>                <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">Border</span> <span style="color: #715ab1; font-style: italic;">BorderBrush</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">Transparent</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">BorderThickness</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">0</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">Background</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">Transparent</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">CornerRadius</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">0</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span>
<span class="linenr">15: </span>                    <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">TabItem</span> <span style="color: #3a81c3; font-style: italic;">x</span><span style="color: #4e3163; font-style: italic;">:</span><span style="color: #715ab1; font-style: italic;">Name</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">tabItem</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">IsSelected</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">{TemplateBinding IsChecked}</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">IsHitTestVisible</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">False</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span>
<span class="linenr">16: </span>                        <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">TabItem.Header</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span>
<span class="linenr">17: </span>                            <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">ContentPresenter</span> <span style="color: #715ab1; font-style: italic;">Margin</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">5</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span>
<span class="linenr">18: </span>                        <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #6c3163; font-weight: bold;">TabItem.Header</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span>
<span class="linenr">19: </span>                    <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #6c3163; font-weight: bold;">TabItem</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span>
<span class="linenr">20: </span>                <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #6c3163; font-weight: bold;">Border</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span>
<span class="linenr">21: </span>                <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">ControlTemplate.Triggers</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span>
<span class="linenr">22: </span>                    <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">Trigger</span> <span style="color: #715ab1; font-style: italic;">Property</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">IsMouseOver</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">Value</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">true</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span>
<span class="linenr">23: </span>                        <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">Setter</span> <span style="color: #715ab1; font-style: italic;">Property</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">Background</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">TargetName</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">tabItem</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">Value</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">{StaticResource TabItemHotBackground}</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span>
<span class="linenr">24: </span>                    <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #6c3163; font-weight: bold;">Trigger</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span>
<span class="linenr">25: </span>                    <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">Trigger</span> <span style="color: #715ab1; font-style: italic;">Property</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">IsChecked</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">Value</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">true</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span>
<span class="linenr">26: </span>                        <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">Setter</span> <span style="color: #715ab1; font-style: italic;">Property</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">Panel.ZIndex</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">Value</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">1</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span>
<span class="linenr">27: </span>                        <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">Setter</span> <span style="color: #715ab1; font-style: italic;">Property</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">Background</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">TargetName</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">tabItem</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">Value</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">{StaticResource TabItemSelectedBackground}</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span>
<span class="linenr">28: </span>                    <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #6c3163; font-weight: bold;">Trigger</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span>
<span class="linenr">29: </span>                    <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">MultiTrigger</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span>
<span class="linenr">30: </span>                        <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">MultiTrigger.Conditions</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span>
<span class="linenr">31: </span>                            <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">Condition</span> <span style="color: #715ab1; font-style: italic;">Property</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">IsChecked</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">Value</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">false</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span>
<span class="linenr">32: </span>                            <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">Condition</span> <span style="color: #715ab1; font-style: italic;">Property</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">IsMouseOver</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">Value</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">true</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span>
<span class="linenr">33: </span>                        <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #6c3163; font-weight: bold;">MultiTrigger.Conditions</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span>
<span class="linenr">34: </span>                        <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #6c3163; font-weight: bold;">Setter</span> <span style="color: #715ab1; font-style: italic;">Property</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">BorderBrush</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">TargetName</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">tabItem</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span> <span style="color: #715ab1; font-style: italic;">Value</span><span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #2d9574;">{StaticResource TabItemHotBorderBrush}</span><span style="color: #2d9574; background-color: #fbf8ef;">"</span><span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span>
<span class="linenr">35: </span>                    <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #6c3163; font-weight: bold;">MultiTrigger</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span>
<span class="linenr">36: </span>                <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #6c3163; font-weight: bold;">ControlTemplate.Triggers</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span>
<span class="linenr">37: </span>            <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #6c3163; font-weight: bold;">ControlTemplate</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span>
<span class="linenr">38: </span>        <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #6c3163; font-weight: bold;">Setter.Value</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span>
<span class="linenr">39: </span>    <span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #6c3163; font-weight: bold;">Setter</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span>
<span class="linenr">40: </span><span style="color: #655370; background-color: #fbf8ef;">&lt;</span><span style="color: #655370; background-color: #fbf8ef;">/</span><span style="color: #6c3163; font-weight: bold;">Style</span><span style="color: #655370; background-color: #fbf8ef;">&gt;</span>
</pre>
</div>

<p>
出处请看这里，<a href="http://stackoverflow.com/questions/4578665/is-there-a-way-to-template-a-radiobutton-so-it-should-tabitem-styled">http://stackoverflow.com/questions/4578665/is-there-a-way-to-template-a-radiobutton-so-it-should-tabitem-styled</a> 。原谅我直接粘贴了代码。我已经好多年没有碰WPF了。但是WPF的思想一直深深地烙印在我的心里。
也许看到上面这坨东西，会令没有WPF经验的人很费解。其实这段代码实现了一个“伪装成Tabs的Radio Buttons”。提到Radio Button给人的第一映像便是一个空心圆形的控件，当选中时，空心圆形变成实心圆形；同一组的Radio Button只有一个能被选中。总结一下：
</p>

<ol class="org-ol">
<li>Radio Button checked=true和checked=false两种状态</li>
<li>同一组Radio Button仅有一个checked=true</li>
<li>同一组Radio Button初始的时候可以一个都不被选中</li>
</ol>

<p>
然后再来看看标签页有什么特性：
</p>

<ol class="org-ol">
<li>每一个tab页有active=true和active=false两种状态</li>
<li>同一组tab页仅有一个active=true</li>
<li>同意组tab页初始的时候必须有一个被选中</li>
</ol>

<p>
这两种控件在行为上是如此相似。以至于可以通过给Radio Button写一个ControlTemplate就能，把一组Radio Button变成tabs。
</p>

<p>
以我浅薄的前端开发经验，我想给上面举得例子做个总结:
</p>

<ol class="org-ol">
<li>组件几乎很难在两个不同的项目里无缝的使用，除非你不在乎它的外观</li>
<li>然而其逻辑几乎可以完美的复用</li>
</ol>

<p>
基于上面的结论，我在 <code>Binding.scala</code> 的基础上定了一个简单的组件模型：
</p>

<div class="org-src-container">
<pre class="src src-scala"><span class="linenr">1: </span><span style="color: #3a81c3; font-weight: bold;">trait</span> <span style="color: #ba2f59; font-weight: bold;">Component</span><span style="color: #3a81c3;">[</span><span style="color: #4e3163;">T</span><span style="color: #3a81c3;">]</span> <span style="color: #3a81c3;">{</span> self<span style="color: #3a81c3; font-weight: bold;">:</span> <span style="color: #ba2f59; font-weight: bold;">T</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span>
<span class="linenr">2: </span>  <span style="color: #6c3163;">@dom</span>
<span class="linenr">3: </span>  <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">render</span><span style="color: #6c3163;">(</span><span style="color: #3a81c3;">implicit</span> template<span style="color: #3a81c3; font-weight: bold;">:</span> <span style="color: #ba2f59; font-weight: bold;">T</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span> <span style="color: #4e3163;">Binding</span><span style="color: #2d9574;">[</span><span style="color: #4e3163;">Node</span><span style="color: #2d9574;">]</span><span style="color: #6c3163;">)</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #6c3163;">{</span>
<span class="linenr">4: </span>    template<span style="color: #2d9574;">(</span>self<span style="color: #2d9574;">)</span>.bind
<span class="linenr">5: </span>  <span style="color: #6c3163;">}</span>
<span class="linenr">6: </span><span style="color: #3a81c3;">}</span>
</pre>
</div>

<p>
就拿杨博文章中的TagPicker作为例子
</p>

<div class="org-src-container">
<pre class="src src-scala"><span class="linenr"> 1: </span><span style="color: #3a81c3; font-weight: bold;">import</span> org.scalajs.dom.raw.<span style="color: #3a81c3;">{</span> <span style="color: #4e3163;">Node</span>, <span style="color: #4e3163;">Event</span>, <span style="color: #4e3163;">HTMLInputElement</span> <span style="color: #3a81c3;">}</span>
<span class="linenr"> 2: </span><span style="color: #3a81c3; font-weight: bold;">import</span> com.thoughtworks.binding.dom
<span class="linenr"> 3: </span><span style="color: #3a81c3; font-weight: bold;">import</span> com.thoughtworks.binding.<span style="color: #4e3163;">Binding</span>
<span class="linenr"> 4: </span><span style="color: #3a81c3; font-weight: bold;">import</span> com.thoughtworks.binding.<span style="color: #4e3163;">Binding</span>.<span style="color: #3a81c3;">{</span> <span style="color: #4e3163;">Var</span>, <span style="color: #4e3163;">Vars</span> <span style="color: #3a81c3;">}</span>
<span class="linenr"> 5: </span>
<span class="linenr"> 6: </span><span style="color: #3a81c3; font-weight: bold;">case</span> <span style="color: #3a81c3; font-weight: bold;">class</span> <span style="color: #ba2f59; font-weight: bold;">TagPicker</span><span style="color: #3a81c3;">(</span>tags<span style="color: #3a81c3; font-weight: bold;">:</span> <span style="color: #ba2f59; font-weight: bold;">Vars</span><span style="color: #6c3163;">[</span><span style="color: #4e3163;">String</span><span style="color: #6c3163;">]</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3; font-weight: bold;">extends</span> <span style="color: #ba2f59; font-weight: bold;">Component</span><span style="color: #3a81c3;">[</span><span style="color: #4e3163;">TagPicker</span><span style="color: #3a81c3;">]</span> <span style="color: #3a81c3;">{</span>
<span class="linenr"> 7: </span>  <span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">text</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #4e3163;">Var</span><span style="color: #6c3163;">(</span><span style="color: #2d9574;">""</span><span style="color: #6c3163;">)</span>
<span class="linenr"> 8: </span>
<span class="linenr"> 9: </span>  <span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">textChangeHandler</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #6c3163;">{</span> e<span style="color: #3a81c3; font-weight: bold;">:</span> <span style="color: #ba2f59; font-weight: bold;">Event</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span>
<span class="linenr">10: </span>    e.target <span style="color: #3a81c3; font-weight: bold;">match</span> <span style="color: #2d9574;">{</span>
<span class="linenr">11: </span>      <span style="color: #3a81c3; font-weight: bold;">case</span> <span style="color: #715ab1;">i</span><span style="color: #3a81c3; font-weight: bold;">:</span> <span style="color: #ba2f59; font-weight: bold;">HTMLInputElement</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span>
<span class="linenr">12: </span>        text := i.value
<span class="linenr">13: </span>      <span style="color: #3a81c3; font-weight: bold;">case</span> <span style="color: #3a81c3; font-weight: bold;">_</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span>
<span class="linenr">14: </span>    <span style="color: #2d9574;">}</span>
<span class="linenr">15: </span>  <span style="color: #6c3163;">}</span>
<span class="linenr">16: </span>
<span class="linenr">17: </span>  <span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">addHandler</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #6c3163;">{</span> e<span style="color: #3a81c3; font-weight: bold;">:</span> <span style="color: #ba2f59; font-weight: bold;">Event</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span>
<span class="linenr">18: </span>    text.get <span style="color: #3a81c3; font-weight: bold;">match</span> <span style="color: #2d9574;">{</span>
<span class="linenr">19: </span>      <span style="color: #3a81c3; font-weight: bold;">case</span> <span style="color: #2d9574;">""</span> | <span style="color: #4e3163;">null</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span>
<span class="linenr">20: </span>      <span style="color: #3a81c3; font-weight: bold;">case</span> <span style="color: #715ab1;">value</span> <span style="color: #3a81c3; font-weight: bold;">if</span> !tags.get.contains<span style="color: #67b11d;">(</span>value<span style="color: #67b11d;">)</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span>
<span class="linenr">21: </span>        tags.get += value
<span class="linenr">22: </span>        text := <span style="color: #2d9574;">""</span>
<span class="linenr">23: </span>    <span style="color: #2d9574;">}</span>
<span class="linenr">24: </span>  <span style="color: #6c3163;">}</span>
<span class="linenr">25: </span>
<span class="linenr">26: </span>  <span style="color: #3a81c3; font-weight: bold;">val</span> <span style="color: #715ab1;">removeHandler</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #6c3163;">{</span> value<span style="color: #3a81c3; font-weight: bold;">:</span> <span style="color: #ba2f59; font-weight: bold;">String</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span>
<span class="linenr">27: </span>    <span style="color: #2d9574;">{</span> e<span style="color: #3a81c3; font-weight: bold;">:</span> <span style="color: #ba2f59; font-weight: bold;">Event</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span>
<span class="linenr">28: </span>      tags.get -= value
<span class="linenr">29: </span>    <span style="color: #2d9574;">}</span>
<span class="linenr">30: </span>  <span style="color: #6c3163;">}</span>
<span class="linenr">31: </span><span style="color: #3a81c3;">}</span>
<span class="linenr">32: </span>
<span class="linenr">33: </span><span style="color: #3a81c3; font-weight: bold;">object</span> <span style="color: #4e3163;">TagPicker</span> <span style="color: #3a81c3;">{</span>
<span class="linenr">34: </span>
<span class="linenr">35: </span>  <span style="color: #6c3163;">@dom</span>
<span class="linenr">36: </span>  <span style="color: #3a81c3;">implicit</span> <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">defaultTemplate</span><span style="color: #6c3163;">(</span>self<span style="color: #3a81c3; font-weight: bold;">:</span> <span style="color: #ba2f59; font-weight: bold;">TagPicker</span><span style="color: #6c3163;">)</span><span style="color: #3a81c3; font-weight: bold;">:</span> <span style="color: #ba2f59; font-weight: bold;">Binding</span><span style="color: #6c3163;">[</span><span style="color: #4e3163;">Node</span><span style="color: #6c3163;">]</span> <span style="color: #3a81c3; font-weight: bold;">=</span> <span style="color: #6c3163;">{</span>
<span class="linenr">37: </span>    &lt;section&gt;
<span class="linenr">38: </span>      &lt;div&gt;<span style="color: #2d9574;">{</span>
<span class="linenr">39: </span>        <span style="color: #3a81c3; font-weight: bold;">for</span> <span style="color: #67b11d;">(</span>tag <span style="color: #3a81c3; font-weight: bold;">&lt;-</span> self.tags<span style="color: #67b11d;">)</span> <span style="color: #3a81c3; font-weight: bold;">yield</span> <span style="color: #67b11d;">{</span>
<span class="linenr">40: </span>          &lt;span&gt;
<span class="linenr">41: </span>            <span style="color: #b1951d;">{</span> tag <span style="color: #b1951d;">}</span>
<span class="linenr">42: </span>            &lt;button onclick<span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #b1951d;">{</span> self.removeHandler<span style="color: #3a81c3;">(</span>tag<span style="color: #3a81c3;">)</span> <span style="color: #b1951d;">}</span>&gt;x&lt;/button&gt;
<span class="linenr">43: </span>          &lt;/span&gt;
<span class="linenr">44: </span>        <span style="color: #67b11d;">}</span>
<span class="linenr">45: </span>      <span style="color: #2d9574;">}</span>&lt;/div&gt;
<span class="linenr">46: </span>      &lt;div&gt;
<span class="linenr">47: </span>        &lt;input value<span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574;">{</span> self.text.bind <span style="color: #2d9574;">}</span> onchange<span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574;">{</span> self.textChangeHandler <span style="color: #2d9574;">}</span>/&gt;
<span class="linenr">48: </span>        &lt;button onclick<span style="color: #3a81c3; font-weight: bold;">=</span><span style="color: #2d9574;">{</span> self.addHandler <span style="color: #2d9574;">}</span>&gt;<span style="color: #4e3163;">Add</span>&lt;/button&gt;
<span class="linenr">49: </span>      &lt;/div&gt;
<span class="linenr">50: </span>    &lt;/section&gt;
<span class="linenr">51: </span>  <span style="color: #6c3163;">}</span>
<span class="linenr">52: </span><span style="color: #3a81c3;">}</span>
</pre>
</div>

<p>
完整的代码如下：
</p>

<iframe height="300" frameborder="0" style="width: 100%; overflow: hidden;" src="https://embed.scalafiddle.io/embed?sfid=7FeEumS/0&theme=dark"></iframe>

<p>
这里运用了几个scala代码的技巧。
</p>

</div>
</div>
    <div>
      <div class="post-meta">
        <span title="post date" class="post-info">2016-12-31</span>
        <span title="last modification date" class="post-info">2017-01-18</span>
        <span title="tags" class="post-info"><a href="/tags/javascript/">javascript</a>, <a href="/tags/scalajs/">scala.js</a>, <a href="/tags/scala/">scala</a></span>
        <span title="author" class="post-info">Shane Xu</span>
      </div>
      <section>
        <h1>Comments</h1>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
          //var disqus_developer = 1;
          var disqus_identifier = "/blog/2016/12/31/binding.scala-in-practice";
          var disqus_url = "https://xusheng.org/blog/2016/12/31/binding.scala-in-practice";
          var disqus_shortname = 'shanexu';
          /* * * DON'T EDIT BELOW THIS LINE * * */
          (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="//disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
       <div id="hashover"></div>
       <script type="text/javascript" src="/hashover.php"></script>
       <noscript>You must have JavaScript enabled to use the comments.</noscript>
      </section>
      <script src="//code.jquery.com/jquery-latest.min.js"></script>
      <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script src="/media/js/main.js"></script>
      <script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-74684473-1']);
        _gaq.push(['_trackPageview']);
        (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
      </script>
      <div class="footer">
        <p>Generated by <a href="http://www.gnu.org/software/emacs/">Emacs</a> 29.x (<a href="http://orgmode.org">Org mode</a> 9.x)</p>
        <p>
          Copyright &copy; 2012 - <span id="footerYear"></span> <a href="mailto:xusheng0711 &lt;at&gt; gmail &lt;dot&gt; com">Shane Xu</a>
          &nbsp;&nbsp;-&nbsp;&nbsp;
          Powered by <a href="https://github.com/kelvinh/org-page" target="_blank">org-page</a>
          <script type="text/javascript">document.getElementById("footerYear").innerHTML = (new Date()).getFullYear();</script>
        </p>
      </div>
    </div>

  </body>
</html>
